{
  "hash": "0190a88f5acd3e92fbed86ccc9a07d26",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 1: Geospatial Analytics for Social Good: Application of Spatial and Spatio-temporal Point Patterns Analysis to discover the geographical distribution of Armed Conflict in Myanmar\"\nauthor: \"Pan Mingwei\"\ndate: \"September 5, 2024\"\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n  cache: true\nformat: \n  html: \n    code-fold: false\n    code-summary: \"Click to expand/collapse code\"\n---\n\n\n# 1. Overview\n\nMillions of people have their lives shattered by armed conflict – wars – every year.\n\nArmed conflict has been on the rise since about 2012, after a decline in the 1990s and early 2000s. First came conflicts in Libya, Syria and Yemen, triggered by the 2011 Arab uprisings. Libya’s instability spilled south, helping set off a protracted crisis in the Sahel region. A fresh wave of major combat followed: the 2020 Azerbaijani-Armenian war over the Nagorno-Karabakh enclave, horrific fighting in Ethiopia’s northern Tigray region that began weeks later, the conflict prompted by the Myanmar army’s 2021 power grab and Russia’s 2022 assault on Ukraine. Add to those 2023’s devastation in Sudan and Gaza. Around the globe, more people are dying in fighting, being forced from their homes or in need of life-saving aid than in decades.\n\n## 1.1 Objective\n\nGeospatial analytics hold tremendous potential to address complex problems facing society. In this study, I will apply spatial point patterns analysis methods to discover the spatial and spatio-temporal distribution of armed conflict in Myanmar.\n\n## 1.2 Data\n\n### 1.2.1 Armed Conflict Data\n\nFor the purpose of this assignment, armed conflict data of Myanmar between 2021-2024 from [Armed Conflict Location & Event Data (ACLED)](https://acleddata.com/), an independent, impartial, international non-profit organization collecting data on violent conflict and protest in all countries and territories in the world, should be used.\n\nIn terms of event types, I will focus on at least four main event types, namely: Battles, Explosion/Remote violence, Strategic developments, and Violence against civilians.\n\nIn terms of study period, I will focus on quarterly armed conflict events from January 2021 until June 2024.\n\n### 1.2.2 GIS Data\n\nI will be using [**Myanmar State and Region Boundaries with Sub-regions MIMU v9.4**](http://geonode.themimu.info/layers/geonode%3Ammr_polbnda2_adm1_250k_mimu_1)**.**\n\n## 1.3 Importing Packages\n\nThe following R packages are used for this assignment:\n\n-   **sf**, for importing, managing and processing geospatial data.\n\n-   **tidyverse**, for importing, wrangling and visualising data.\n\n-   **tmap**, to create thematic maps.\n\n-   **spatstat**, for point pattern analysis.\n\n-   **raster**,to reads, writes, manipulates, analyses and model of gridded spatial data (i.e. raster).\n\n-   **sparr**, provides functions for kernel density estimation.\n\n-   [**magick**](https://cran.r-project.org/web/packages/magick/vignettes/intro.html), modern and simple toolkit for image processing in R.\n\n-   **gifski**, to create animated GIFs.\n\n-   [**stpp**](https://cran.r-project.org/web/packages/stpp/stpp.pdf), for spatio-temporal analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf,tidyverse,tmap,spatstat,sparr,raster,magick,gifski,stpp)\n```\n:::\n\n\n# 2. Data Wrangling\n\n## 2.1 Aspatial Data\n\n### 2.1.1 Importing Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- read_csv(\"data/aspatial/2021-01-01-2024-06-30-Myanmar.csv\")\n```\n:::\n\n\n### 2.1.2 CRS Adjustment\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(acled_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System: NA\n```\n\n\n:::\n:::\n\n\nAs the current **acled_sf** do not have CRS, which means there is no geometry column in the sf object. Therefore, before we change the CRS, we need to convert the **longitude** and **latitude** columns into a **spatial format**. Since Myanmar is UTM zone 47(EPSG:32647), lets create the geometry column and transform the CRS to `UTM Zone 47N`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- acled_sf %>%\n  st_as_sf(coords = c(\"longitude\", \"latitude\"), crs=4326) %>%\n  st_transform(crs = 32647)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(acled_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: EPSG:32647 \n  wkt:\nPROJCRS[\"WGS 84 / UTM zone 47N\",\n    BASEGEOGCRS[\"WGS 84\",\n        ENSEMBLE[\"World Geodetic System 1984 ensemble\",\n            MEMBER[\"World Geodetic System 1984 (Transit)\"],\n            MEMBER[\"World Geodetic System 1984 (G730)\"],\n            MEMBER[\"World Geodetic System 1984 (G873)\"],\n            MEMBER[\"World Geodetic System 1984 (G1150)\"],\n            MEMBER[\"World Geodetic System 1984 (G1674)\"],\n            MEMBER[\"World Geodetic System 1984 (G1762)\"],\n            MEMBER[\"World Geodetic System 1984 (G2139)\"],\n            MEMBER[\"World Geodetic System 1984 (G2296)\"],\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ENSEMBLEACCURACY[2.0]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4326]],\n    CONVERSION[\"UTM zone 47N\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",99,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",0.9996,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",500000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Navigation and medium accuracy spatial referencing.\"],\n        AREA[\"Between 96°E and 102°E, northern hemisphere between equator and 84°N, onshore and offshore. China. Indonesia. Laos. Malaysia - West Malaysia. Mongolia. Myanmar (Burma). Russian Federation. Thailand.\"],\n        BBOX[0,96,84,102]],\n    ID[\"EPSG\",32647]]\n```\n\n\n:::\n:::\n\n\nWe can see that now the CRS is `UTM Zone 47` now.\n\n### 2.1.3 Check and Clean Aspatial Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(acled_sf, n =1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 1 feature and 29 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 214961 ymin: 2452068 xmax: 214961 ymax: 2452068\nProjected CRS: WGS 84 / UTM zone 47N\n# A tibble: 1 × 30\n  event_id_cnty event_date    year time_precision disorder_type      event_type\n  <chr>         <chr>        <dbl>          <dbl> <chr>              <chr>     \n1 MMR64313      30 June 2024  2024              1 Political violence Battles   \n# ℹ 24 more variables: sub_event_type <chr>, actor1 <chr>, assoc_actor_1 <chr>,\n#   inter1 <dbl>, actor2 <chr>, assoc_actor_2 <chr>, inter2 <dbl>,\n#   interaction <dbl>, civilian_targeting <chr>, iso <dbl>, region <chr>,\n#   country <chr>, admin1 <chr>, admin2 <chr>, admin3 <chr>, location <chr>,\n#   geo_precision <dbl>, source <chr>, source_scale <chr>, notes <chr>,\n#   fatalities <dbl>, tags <chr>, timestamp <dbl>, geometry <POINT [m]>\n```\n\n\n:::\n:::\n\n\nBy checking the data, we can see that the data type for **event_date** was in Character instead of Date. And there is a timestamp field, in order to figure out what is this field for, we need to convert it to human readable as well.\n\nLets convert the data type for **event_date** to Date and **timestamp** to normal date time format, so we handle the field easier at later stage.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- acled_sf %>%\n  mutate(event_date = dmy(event_date)) %>%\n  mutate(timestamp = as.POSIXct(timestamp, origin = \"1970-01-01\", tz = \"Asia/Yangon\"))\n```\n:::\n\n\nBy looking at the data, it seems that the **timestamp** field was the date time when the data was recorded. Therefore, this field would not be useful for us.\n\n### 2.1.4 Data Transformation\n\nSince we will be focus on quarterly, lets extract **year** and **quarter** from **event_date** field.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- acled_sf %>%\n  mutate(year = year(event_date),\n         quarter = quarter(event_date))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(acled_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n event_id_cnty        event_date              year      time_precision \n Length:42608       Min.   :2021-01-01   Min.   :2021   Min.   :1.000  \n Class :character   1st Qu.:2022-01-10   1st Qu.:2022   1st Qu.:1.000  \n Mode  :character   Median :2022-10-13   Median :2022   Median :1.000  \n                    Mean   :2022-10-29   Mean   :2022   Mean   :1.053  \n                    3rd Qu.:2023-08-29   3rd Qu.:2023   3rd Qu.:1.000  \n                    Max.   :2024-06-30   Max.   :2024   Max.   :3.000  \n disorder_type       event_type        sub_event_type        actor1         \n Length:42608       Length:42608       Length:42608       Length:42608      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n assoc_actor_1          inter1         actor2          assoc_actor_2     \n Length:42608       Min.   :1.000   Length:42608       Length:42608      \n Class :character   1st Qu.:1.000   Class :character   Class :character  \n Mode  :character   Median :1.000   Mode  :character   Mode  :character  \n                    Mean   :1.947                                        \n                    3rd Qu.:3.000                                        \n                    Max.   :8.000                                        \n     inter2       interaction    civilian_targeting      iso     \n Min.   :0.000   Min.   :10.00   Length:42608       Min.   :104  \n 1st Qu.:1.000   1st Qu.:13.00   Class :character   1st Qu.:104  \n Median :3.000   Median :17.00   Mode  :character   Median :104  \n Mean   :3.597   Mean   :18.86                      Mean   :104  \n 3rd Qu.:7.000   3rd Qu.:17.00                      3rd Qu.:104  \n Max.   :8.000   Max.   :80.00                      Max.   :104  \n    region            country             admin1             admin2         \n Length:42608       Length:42608       Length:42608       Length:42608      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n    admin3            location         geo_precision      source         \n Length:42608       Length:42608       Min.   :1.000   Length:42608      \n Class :character   Class :character   1st Qu.:1.000   Class :character  \n Mode  :character   Mode  :character   Median :1.000   Mode  :character  \n                                       Mean   :1.495                     \n                                       3rd Qu.:2.000                     \n                                       Max.   :3.000                     \n source_scale          notes             fatalities         tags          \n Length:42608       Length:42608       Min.   :  0.00   Length:42608      \n Class :character   Class :character   1st Qu.:  0.00   Class :character  \n Mode  :character   Mode  :character   Median :  0.00   Mode  :character  \n                                       Mean   :  1.27                     \n                                       3rd Qu.:  1.00                     \n                                       Max.   :201.00                     \n   timestamp                               geometry        quarter     \n Min.   :2021-01-19 23:11:26.00   POINT        :42608   Min.   :1.000  \n 1st Qu.:2023-12-12 07:49:10.00   epsg:32647   :    0   1st Qu.:2.000  \n Median :2024-04-24 01:54:16.00   +proj=utm ...:    0   Median :2.000  \n Mean   :2023-12-06 06:04:20.38                         Mean   :2.475  \n 3rd Qu.:2024-06-26 04:30:11.00                         3rd Qu.:4.000  \n Max.   :2024-09-04 08:18:12.00                         Max.   :4.000  \n```\n\n\n:::\n:::\n\n\n#### 2.1.4.1 Handling Categorical Data\n\nSince there are fields in the dataset are categorical related fields and they are in character vectors. To make sure consistency of the data, we can use `as.factor` function to convert the variable to categorical variable. These fields are: **disorder_type**, **event_type**, **sub_event_type**, **actor1**, **actor2**, **admin1** , **source_scale** etc.\n\nBy doing so, it makes easier to group and summarize data by categories and will provide more consistent behavior.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- acled_sf %>%\n  mutate( event_type = as.factor(event_type),\n          admin1 = as.factor(admin1)\n         )\n```\n:::\n\n\n::: callout-note\nAs there are other categorical fields, but since not all the field will be used and useful(as some of the field have too many level), hence I only factor fields that will be useful for the next stage.\n:::\n\nTo conserve memory, we should select only the fields relevant to the analysis and save them in RDS format, making it more convenient for future reference.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- acled_sf %>%\n  dplyr::select(event_date,year,quarter,event_type,actor1,admin1,fatalities)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(acled_sf, \"data/rds/acled_sf.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- read_rds( \"data/rds/acled_sf.rds\")\n```\n:::\n\n\nTo check the levels.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlevels(acled_sf$event_type)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Battles\"                    \"Explosions/Remote violence\"\n[3] \"Protests\"                   \"Riots\"                     \n[5] \"Strategic developments\"     \"Violence against civilians\"\n```\n\n\n:::\n:::\n\n\n## 2.2 Geospatial Data\n\n### 2.2.1 Importing Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmsrb_sub_reg <- st_read(dsn = \"data/geospatial/mmr_polbnda2_adm1_250k_mimu_1\", layer = \"mmr_polbnda2_adm1_250k_mimu_1\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `mmr_polbnda2_adm1_250k_mimu_1' from data source \n  `/Users/mingwei/Desktop/SMU/Y3S1/IS415/xXxPMWxXx/IS415-GAA/Take-home_Ex/Take-home_Ex01/data/geospatial/mmr_polbnda2_adm1_250k_mimu_1' \n  using driver `ESRI Shapefile'\nSimple feature collection with 18 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n:::\n\n\n### 2.2.2 CRS Adjustments\n\nLets check what is the CRS for `msrb_sub_reg`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(msrb_sub_reg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"latitude\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"longitude\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n```\n\n\n:::\n:::\n\n\nAs from above, we can see that the original data is geographic coordinate system. We need to convert it to projected coordinate system. Since Myanmar is UTM zone 47(EPSG:32647), lets transform the CRS to `UTM Zone 47N`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmsrb_sub_reg <- st_transform(msrb_sub_reg, crs = 32647)\nst_crs(msrb_sub_reg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: EPSG:32647 \n  wkt:\nPROJCRS[\"WGS 84 / UTM zone 47N\",\n    BASEGEOGCRS[\"WGS 84\",\n        ENSEMBLE[\"World Geodetic System 1984 ensemble\",\n            MEMBER[\"World Geodetic System 1984 (Transit)\"],\n            MEMBER[\"World Geodetic System 1984 (G730)\"],\n            MEMBER[\"World Geodetic System 1984 (G873)\"],\n            MEMBER[\"World Geodetic System 1984 (G1150)\"],\n            MEMBER[\"World Geodetic System 1984 (G1674)\"],\n            MEMBER[\"World Geodetic System 1984 (G1762)\"],\n            MEMBER[\"World Geodetic System 1984 (G2139)\"],\n            MEMBER[\"World Geodetic System 1984 (G2296)\"],\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ENSEMBLEACCURACY[2.0]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4326]],\n    CONVERSION[\"UTM zone 47N\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",99,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",0.9996,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",500000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Navigation and medium accuracy spatial referencing.\"],\n        AREA[\"Between 96°E and 102°E, northern hemisphere between equator and 84°N, onshore and offshore. China. Indonesia. Laos. Malaysia - West Malaysia. Mongolia. Myanmar (Burma). Russian Federation. Thailand.\"],\n        BBOX[0,96,84,102]],\n    ID[\"EPSG\",32647]]\n```\n\n\n:::\n:::\n\n\n### 2.2.3 Check and Clean Geospatial Data\n\nTo ensure that the geometries in the shapefile are valid and correct them if any invalid geometries found.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Check if the data are valid\nst_is_valid(msrb_sub_reg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE\n[16] TRUE TRUE TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\n# Fix invalid data\nmsrb_sub_reg <- st_make_valid(msrb_sub_reg)\n```\n:::\n\n\n### 2.2.4 Standardize Column Names\n\nWe can see that the column name are not descriptive.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmsrb_sub_reg\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 18 features and 6 fields\nGeometry type: GEOMETRY\nDimension:     XY\nBounding box:  xmin: -210008.6 ymin: 1072026 xmax: 724647.6 ymax: 3158467\nProjected CRS: WGS 84 / UTM zone 47N\nFirst 10 features:\n   OBJECTID          ST ST_PCODE  ST_RG               ST_MMR PCode_V\n1         1  Ayeyarwady   MMR017 Region       ဧရာဝတီတိုင်းဒေသကြီး     9.4\n2         2 Bago (East)   MMR007 Region   ပဲခူးတိုင်းဒေသကြီး (အရှေ့)     9.4\n3         3 Bago (West)   MMR008 Region ပဲခူးတိုင်းဒေသကြီး (အနောက်)     9.4\n4         4        Chin   MMR004  State            ချင်းပြည်နယ်     9.4\n5         5      Kachin   MMR001  State            ကချင်ပြည်နယ်     9.4\n6         6       Kayah   MMR002  State            ကယားပြည်နယ်     9.4\n7         7       Kayin   MMR003  State             ကရင်ပြည်နယ်     9.4\n8         8      Magway   MMR009 Region        မကွေးတိုင်းဒေသကြီး     9.4\n9         9    Mandalay   MMR010 Region      မန္တလေးတိုင်းဒေသကြီး     9.4\n10       10         Mon   MMR011  State              မွန်ပြည်နယ်     9.4\n                         geometry\n1  MULTIPOLYGON (((-5792.088 1...\n2  POLYGON ((203949.9 2157841,...\n3  POLYGON ((153405.1 2125288,...\n4  POLYGON ((-72918.03 2675831...\n5  POLYGON ((362696.3 3156293,...\n6  POLYGON ((309155.7 2211716,...\n7  MULTIPOLYGON (((373550.1 18...\n8  POLYGON ((-1717.607 2525523...\n9  POLYGON ((208184.3 2614332,...\n10 MULTIPOLYGON (((350576.4 17...\n```\n\n\n:::\n:::\n\n\nRename the column name to more descriptive name and remove not useful column .\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmsrb_sub_reg <- msrb_sub_reg %>%\n  rename(state_name = ST,\n         state_pcode = ST_PCODE,\n         state_region = ST_RG) %>%\n  dplyr::select(-ST_MMR)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(msrb_sub_reg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    OBJECTID      state_name        state_pcode        state_region      \n Min.   : 1.00   Length:18          Length:18          Length:18         \n 1st Qu.: 5.25   Class :character   Class :character   Class :character  \n Median : 9.50   Mode  :character   Mode  :character   Mode  :character  \n Mean   : 9.50                                                           \n 3rd Qu.:13.75                                                           \n Max.   :18.00                                                           \n    PCode_V             geometry \n Min.   :9.4   MULTIPOLYGON : 6  \n 1st Qu.:9.4   POLYGON      :12  \n Median :9.4   epsg:32647   : 0  \n Mean   :9.4   +proj=utm ...: 0  \n 3rd Qu.:9.4                     \n Max.   :9.4                     \n```\n\n\n:::\n:::\n\n\n### 2.2.5 Myanmar Boundaries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(st_geometry(msrb_sub_reg))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-22-1.png){width=1152}\n:::\n:::\n\n\nSave into RDS, for future use.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(msrb_sub_reg,\"data/rds/msrb_sub_reg.rds\")\n```\n:::\n\n\n### 2.2.6 Myanmar Boundaries With State Name\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = msrb_sub_reg) +\n  geom_sf(aes(fill = state_name), color = \"black\") + \n  geom_sf_label(aes(label = state_name), size = 4, color = \"black\",fill = \"white\", label.size = 0.5) + \n  scale_fill_hue(n = length(unique(msrb_sub_reg$state_name))) +\n  theme(legend.position = \"right\") +\n  ggtitle(\"Myanmar Administrative Boundaries\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-24-1.png){width=960}\n:::\n:::\n\n\n# 3 Kernel Density Estimation\n\n## 3.1 Remove island\n\nAs we can see from above, the Myanmar boundaries have many islands, which will affect us as when plot the points. Therefore, by removing smaller island,it will help us in visualization.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Merge adj polygons\nmerged_msrb <- st_union(msrb_sub_reg) %>%\n  st_cast(\"POLYGON\")\n# Convert back to sf object\nmerged_msrb <- st_as_sf(merged_msrb)\n# set threshold\nmin_area_threshold <- units::set_units(100, \"km^2\")\n\nareas <- st_area(merged_msrb)\n\n# Filter out polygons smaller than the threshold\nfiltered_msrb <- merged_msrb %>% \n  filter(areas > min_area_threshold)\n\nplot(st_geometry(filtered_msrb), main = \"Without Small Islands\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-25-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(filtered_msrb, \"data/rds/filtered_msrb.rds\")\n```\n:::\n\n\n## 3.2 Create owin Object\n\nAfter removing the small island, we can now create an **owin** (observed window) object, which we will use when creating the KDE layer.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmsrb_owin <- as.owin(filtered_msrb)\nplot(msrb_owin)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-27-1.png){width=1152}\n:::\n:::\n\n\n## 3.3 Determine Best Sigma And Kernel\n\nTo find out which sigma and kernel to use for KDE, we will try various type and see which give us the best visualization. We will use data that is battles event in 2021 Q1 as the sample data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbattles_2021_Q1 <- acled_sf %>%\n  filter(event_type == 'Battles' & year == 2021 & quarter == 1)\n\nbattles_2021_Q1_ppp <- as.ppp(st_coordinates(battles_2021_Q1), st_bbox(battles_2021_Q1))\nany(duplicated(battles_2021_Q1_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n:::\n\n\nUsing *`jittering`*, to add a small perturbation to the duplicate points so that they do not occupy the exact same space.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbattles_2021_Q1_ppp <- rjitter(battles_2021_Q1_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\nany(duplicated(battles_2021_Q1_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n:::\n\n\nTo apply the **owin** object to the **ppp** object.”\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbattles_2021_Q1_ppp = battles_2021_Q1_ppp[msrb_owin]\nplot(battles_2021_Q1_ppp, pch = 20, cex = 1)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-30-1.png){width=1152}\n:::\n:::\n\n\n### 3.3.1 Comparing Different Sigma\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\npar(mar = c(3, 3, 2, 1))  # adjust the margin values\n\nplot(density(battles_2021_Q1_ppp, sigma = bw.ppl, edge = TRUE, kernel = \"gaussian\"), main = \"PPL\")\nplot(density(battles_2021_Q1_ppp, sigma = bw.CvL, edge = TRUE, kernel = \"gaussian\"), main = \"CvL\")\nplot(density(battles_2021_Q1_ppp, sigma = bw.scott, edge = TRUE, kernel = \"gaussian\"), main = \"Scott\")\nplot(density(battles_2021_Q1_ppp, sigma = bw.diggle, edge = TRUE, kernel = \"gaussian\"), main = \"Diggle\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-31-1.png){width=1152}\n:::\n:::\n\n\n::: callout-note\nAs can be seen above, among the four types of sigma, `PPL` provides the best visualization. Both Scott and CvL methods result in too much spread, while Diggle makes it difficult to see the points in the bottom part of the plot.\n:::\n\n### 3.3.2 Comparing Different Kernel\n\nCheck the bandwidth for `bw.ppl`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbw <- bw.ppl(battles_2021_Q1_ppp)\nbw\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   sigma \n43203.34 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Rescale the measurement unit\nbattles_2021_Q1_ppp.km <- rescale(battles_2021_Q1_ppp, 55000, \"km\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\npar(mar = c(3, 3, 2, 1))\n\nplot(density(battles_2021_Q1_ppp.km, sigma = bw.ppl, edge = TRUE, kernel = \"gaussian\"), main = \"Gaussian\")\nplot(density(battles_2021_Q1_ppp.km, sigma = bw.ppl, edge = TRUE, kernel = \"epanechnikov\"), main = \"Epanechnikov\")\nplot(density(battles_2021_Q1_ppp.km, sigma = bw.ppl, edge = TRUE, kernel = \"quartic\"), main = \"Quartic\")\nplot(density(battles_2021_Q1_ppp.km, sigma = bw.ppl, edge = TRUE, kernel = \"disc\"), main = \"Disc\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-34-1.png){width=1152}\n:::\n:::\n\n\n::: callout-note\nAmong the four kernels, the `Gaussian` kernel provides the smoothest visualization. Therefore, we will use Gaussian kernel for our analysis.\n:::\n\n## 3.4 AY2021\n\nAs I am interested in understanding an overall picture of the conflict situation each year, including how different types of conflicts happen concurrently. Therefore, I will analysis it by year and event type. By doing this way it will give me the following pros and cons:\n\n-   Pros:\n\n    -   **Holistic View**: I can compare multiple event types within the same time frame, identifying relationships or patterns between them.\n\n    -   **Comprehensive Spatial Understanding**: Provide a snapshot of all event types within a year, is there any interactions between event type. (e.g. Battles occur near Violence against civilians)\n\n-   Cons:\n\n    -   **Temporal Trends Less Visible**: This way does not provide insight into how a specific event type evolves over the years.\n\n### 3.4.1 Q1\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nevent_types <- c(\"Battles\", \"Explosions/Remote violence\", \"Strategic developments\", \"Violence against civilians\")\n\npar(mfrow = c(2, 2))\npar(mar = c(3, 3, 2, 1))\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  filtered_data <- acled_sf %>%\n    filter(event_type == event & year == 2021 & quarter == 1)\n  \n  # Convert to ppp format\n  ppp_data <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n  \n  # Handle duplicated points\n  ppp_data <- rjitter(ppp_data, retry = TRUE, nsim = 1, drop = TRUE)\n  \n  # Extract conflict Event located within Myanmar\n  ppp_data <- ppp_data[msrb_owin]\n  \n  # Re-scale\n  ppp_data.km <- rescale(ppp_data, 55000, \"km\")\n  \n  # Plot KDE\n  plot(density(ppp_data.km, \n               sigma = bw.ppl, \n               edge = TRUE, \n               kernel = \"gaussian\"), \n       main = paste(\"2021 Q1 -\", event))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-35-1.png){width=1152}\n:::\n:::\n\n\n### 3.4.2 Q2\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\npar(mar = c(3, 3, 2, 1))\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  filtered_data <- acled_sf %>%\n    filter(event_type == event & year == 2021 & quarter == 2)\n  \n  # Convert to ppp format\n  ppp_data <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n  \n  # Handle duplicated points\n  ppp_data <- rjitter(ppp_data, retry = TRUE, nsim = 1, drop = TRUE)\n  \n  # Extract conflict Event located within Myanmar\n  ppp_data <- ppp_data[msrb_owin]\n  \n  # Re-scale\n  ppp_data.km <- rescale(ppp_data, 55000, \"km\")\n  \n  # Plot density\n  plot(density(ppp_data.km, \n               sigma = bw.ppl, \n               edge = TRUE, \n               kernel = \"gaussian\"), \n       main = paste(\"2021 Q2 -\", event))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-36-1.png){width=1152}\n:::\n:::\n\n\n### 3.4.3 Q3\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\npar(mar = c(3, 3, 2, 1))\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  filtered_data <- acled_sf %>%\n    filter(event_type == event & year == 2021 & quarter == 3)\n  \n  # Convert to ppp format\n  ppp_data <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n  \n  # Handle duplicated points\n  ppp_data <- rjitter(ppp_data, retry = TRUE, nsim = 1, drop = TRUE)\n  \n  # Extract conflict Event located within Myanmar\n  ppp_data <- ppp_data[msrb_owin]\n  \n  # Re-scale\n  ppp_data.km <- rescale(ppp_data, 55000, \"km\")\n  \n  # Plot density\n  plot(density(ppp_data.km, \n               sigma = bw.ppl, \n               edge = TRUE, \n               kernel = \"gaussian\"), \n       main = paste(\"2021 Q3 -\", event))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-37-1.png){width=1152}\n:::\n:::\n\n\n### 3.4.4 Q4\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\npar(mar = c(3, 3, 2, 1))\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  filtered_data <- acled_sf %>%\n    filter(event_type == event & year == 2021 & quarter == 4)\n  \n  # Convert to ppp format\n  ppp_data <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n  \n  # Handle duplicated points\n  ppp_data <- rjitter(ppp_data, retry = TRUE, nsim = 1, drop = TRUE)\n  \n  # Extract conflict Event located within Myanmar\n  ppp_data <- ppp_data[msrb_owin]\n  \n  # Re-scale\n  ppp_data.km <- rescale(ppp_data, 55000, \"km\")\n  \n  # Plot density\n  plot(density(ppp_data.km, \n               sigma = bw.ppl, \n               edge = TRUE, \n               kernel = \"gaussian\"), \n       main = paste(\"2021 Q4 -\", event))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-38-1.png){width=1152}\n:::\n:::\n\n\n::: callout-tip\n## 2021 Insight\n\n-   In Q1 and Q2 of 2021, we can observe that **Battles** and **Explosions/Remote Violence** tend to occur in similar locations(the boundary between Kachin state and Shan state; Rakhine State and the boundary between Kayin State, Mon State and Yangon Division), suggesting a closer relationship between these two event type.\n\n-   On the other hand, **Strategic Developments** and **Violence Against Civilians** appear to be spatially correlated with each other, mostly at the boundary between Magway Division and Mandalay Division , but less so with **Battles** and **Explosions/Remote Violence.**\n\n-   By Q3 and Q4, as the frequency of conflicts increase, the spatial distribution of all four event type begins to converge mostly at the boundary between Magway Division and Mandalay Division. This suggests that these events are increasingly co-occurring in the similar geographic areas.\n:::\n\n## 3.5 AY2022\n\n### 3.5.1 Q1\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\npar(mar = c(3, 3, 2, 1))\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  filtered_data <- acled_sf %>%\n    filter(event_type == event & year == 2022 & quarter == 1)\n  \n  # Convert to ppp format\n  ppp_data <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n  \n  # Handle duplicated points\n  ppp_data <- rjitter(ppp_data, retry = TRUE, nsim = 1, drop = TRUE)\n  \n  # Extract conflict Event located within Myanmar\n  ppp_data <- ppp_data[msrb_owin]\n  \n  # Re-scale\n  ppp_data.km <- rescale(ppp_data, 55000, \"km\")\n  \n  # Plot density\n  plot(density(ppp_data.km, \n               sigma = bw.ppl, \n               edge = TRUE, \n               kernel = \"gaussian\"), \n       main = paste(\"2022 Q1 -\", event))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-39-1.png){width=1152}\n:::\n:::\n\n\n### 3.5.2 Q2\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\npar(mar = c(3, 3, 2, 1))\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  filtered_data <- acled_sf %>%\n    filter(event_type == event & year == 2022 & quarter == 2)\n  \n  # Convert to ppp format\n  ppp_data <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n  \n  # Handle duplicated points\n  ppp_data <- rjitter(ppp_data, retry = TRUE, nsim = 1, drop = TRUE)\n  \n  # Extract conflict Event located within Myanmar\n  ppp_data <- ppp_data[msrb_owin]\n  \n  # Re-scale\n  ppp_data.km <- rescale(ppp_data, 55000, \"km\")\n  \n  # Plot density\n  plot(density(ppp_data.km, \n               sigma = bw.ppl, \n               edge = TRUE, \n               kernel = \"gaussian\"), \n       main = paste(\"2022 Q2 -\", event))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-40-1.png){width=1152}\n:::\n:::\n\n\n### 3.5.3 Q3\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\npar(mar = c(3, 3, 2, 1))\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  filtered_data <- acled_sf %>%\n    filter(event_type == event & year == 2022 & quarter == 3)\n  \n  # Convert to ppp format\n  ppp_data <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n  \n  # Handle duplicated points\n  ppp_data <- rjitter(ppp_data, retry = TRUE, nsim = 1, drop = TRUE)\n  \n  # Extract conflict Event located within Myanmar\n  ppp_data <- ppp_data[msrb_owin]\n  \n  # Re-scale\n  ppp_data.km <- rescale(ppp_data, 55000, \"km\")\n  \n  # Plot density\n  plot(density(ppp_data.km, \n               sigma = bw.ppl, \n               edge = TRUE, \n               kernel = \"gaussian\"), \n       main = paste(\"2022 Q3 -\", event))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-41-1.png){width=1152}\n:::\n:::\n\n\n### 3.5.4 Q4\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\npar(mar = c(3, 3, 2, 1))\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  filtered_data <- acled_sf %>%\n    filter(event_type == event & year == 2022 & quarter == 4)\n  \n  # Convert to ppp format\n  ppp_data <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n  \n  # Handle duplicated points\n  ppp_data <- rjitter(ppp_data, retry = TRUE, nsim = 1, drop = TRUE)\n  \n  # Extract conflict Event located within Myanmar\n  ppp_data <- ppp_data[msrb_owin]\n  \n  # Re-scale\n  ppp_data.km <- rescale(ppp_data, 55000, \"km\")\n  \n  # Plot density\n  plot(density(ppp_data.km, \n               sigma = bw.ppl, \n               edge = TRUE, \n               kernel = \"gaussian\"), \n       main = paste(\"2022 Q4 -\", event))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-42-1.png){width=1152}\n:::\n:::\n\n\n::: callout-tip\n## 2022 Insight\n\n-   In 2022, conflict levels remained high across all four event types. Most conflicts continued to occur along the boundary between **Magway Division** and **Mandalay Division** (central region). Toward end of the year, there was a noticeable increase in conflicts in the southern region, particularly in Battles and Violence Against Civilians events.\n:::\n\n## 3.6 AY2023\n\n### 3.6.1 Q1\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\npar(mar = c(3, 3, 2, 1))\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  filtered_data <- acled_sf %>%\n    filter(event_type == event & year == 2023 & quarter == 1)\n  \n  # Convert to ppp format\n  ppp_data <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n  \n  # Handle duplicated points\n  ppp_data <- rjitter(ppp_data, retry = TRUE, nsim = 1, drop = TRUE)\n  \n  # Extract conflict Event located within Myanmar\n  ppp_data <- ppp_data[msrb_owin]\n  \n  # Re-scale\n  ppp_data.km <- rescale(ppp_data, 55000, \"km\")\n  \n  # Plot density\n  plot(density(ppp_data.km, \n               sigma = bw.ppl, \n               edge = TRUE, \n               kernel = \"gaussian\"), \n       main = paste(\"2023 Q1 -\", event))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-43-1.png){width=1152}\n:::\n:::\n\n\n### 3.6.2 Q2\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\npar(mar = c(3, 3, 2, 1))\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  filtered_data <- acled_sf %>%\n    filter(event_type == event & year == 2023 & quarter == 2)\n  \n  # Convert to ppp format\n  ppp_data <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n  \n  # Handle duplicated points\n  ppp_data <- rjitter(ppp_data, retry = TRUE, nsim = 1, drop = TRUE)\n  \n  # Extract conflict Event located within Myanmar\n  ppp_data <- ppp_data[msrb_owin]\n  \n  # Re-scale\n  ppp_data.km <- rescale(ppp_data, 55000, \"km\")\n  \n  # Plot density\n  plot(density(ppp_data.km, \n               sigma = bw.ppl, \n               edge = TRUE, \n               kernel = \"gaussian\"), \n       main = paste(\"2023 Q2 -\", event))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-44-1.png){width=1152}\n:::\n:::\n\n\n### 3.6.3 Q3\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\npar(mar = c(3, 3, 2, 1))\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  filtered_data <- acled_sf %>%\n    filter(event_type == event & year == 2023 & quarter == 3)\n  \n  # Convert to ppp format\n  ppp_data <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n  \n  # Handle duplicated points\n  ppp_data <- rjitter(ppp_data, retry = TRUE, nsim = 1, drop = TRUE)\n  \n  # Extract conflict Event located within Myanmar\n  ppp_data <- ppp_data[msrb_owin]\n  \n  # Re-scale\n  ppp_data.km <- rescale(ppp_data, 55000, \"km\")\n  \n  # Plot density\n  plot(density(ppp_data.km, \n               sigma = bw.ppl, \n               edge = TRUE, \n               kernel = \"gaussian\"), \n       main = paste(\"2023 Q3 -\", event))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-45-1.png){width=1152}\n:::\n:::\n\n\n### 3.6.4 Q4\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\npar(mar = c(3, 3, 2, 1))\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  filtered_data <- acled_sf %>%\n    filter(event_type == event & year == 2023 & quarter == 4)\n  \n  # Convert to ppp format\n  ppp_data <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n  \n  # Handle duplicated points\n  ppp_data <- rjitter(ppp_data, retry = TRUE, nsim = 1, drop = TRUE)\n  \n  # Extract conflict Event located within Myanmar\n  ppp_data <- ppp_data[msrb_owin]\n  \n  # Re-scale\n  ppp_data.km <- rescale(ppp_data, 55000, \"km\")\n  \n  # Plot density\n  plot(density(ppp_data.km, \n               sigma = bw.ppl, \n               edge = TRUE, \n               kernel = \"gaussian\"), \n       main = paste(\"2023 Q4 -\", event))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-46-1.png){width=1152}\n:::\n:::\n\n\n::: callout-tip\n## 2023 Insight\n\n-   Overall in 2023, most of the conflict for the four type continued to occur along the boundary between **Magway Division** and **Mandalay Division** (Central Region).\n\n-   However, we can see a decreasing trend in Strategic Developments and Violence Against Civilians (can see from the scale bar at the side)\n\n-   Conversely, Battles and Explosions/Remote Violence increased, with these events gradually shifting toward the boundary between **Kachin State** and **Shan State** (North-Ease Region)by the end of the year.\n:::\n\n## 3.7 AY2024\n\n### 3.7.1 Q1\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\npar(mar = c(3, 3, 2, 1))\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  filtered_data <- acled_sf %>%\n    filter(event_type == event & year == 2024 & quarter == 1)\n  \n  # Convert to ppp format\n  ppp_data <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n  \n  # Handle duplicated points\n  ppp_data <- rjitter(ppp_data, retry = TRUE, nsim = 1, drop = TRUE)\n  \n  # Extract conflict Event located within Myanmar\n  ppp_data <- ppp_data[msrb_owin]\n  \n  # Re-scale\n  ppp_data.km <- rescale(ppp_data, 55000, \"km\")\n  \n  # Plot density\n  plot(density(ppp_data.km, \n               sigma = bw.ppl, \n               edge = TRUE, \n               kernel = \"gaussian\"), \n       main = paste(\"2024 Q1 -\", event))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-47-1.png){width=1152}\n:::\n:::\n\n\n### 3.7.2 Q2\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\npar(mar = c(3, 3, 2, 1))\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  filtered_data <- acled_sf %>%\n    filter(event_type == event & year == 2024 & quarter == 2)\n  \n  # Convert to ppp format\n  ppp_data <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n  \n  # Handle duplicated points\n  ppp_data <- rjitter(ppp_data, retry = TRUE, nsim = 1, drop = TRUE)\n  \n  # Extract conflict Event located within Myanmar\n  ppp_data <- ppp_data[msrb_owin]\n  \n  # Re-scale\n  ppp_data.km <- rescale(ppp_data, 55000, \"km\")\n  \n  # Plot density\n  plot(density(ppp_data.km, \n               sigma = bw.ppl, \n               edge = TRUE, \n               kernel = \"gaussian\"), \n       main = paste(\"2024 Q2 -\", event))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-48-1.png){width=1152}\n:::\n:::\n\n\n::: callout-tip\n## 2024 Insight\n\n-   In the first half of 2024, conflict trends remained similar to those of 2023, with the **Central region** being the primary hotspot, followed by the **Southern region**. However, there was a significant increase in conflict in **Rakhine State** during this period.\n\n-   In term of co-relation between event types, **Battles** and **Explosions/Remote Violence** remained strongly correlated, while **Strategic Developments** and **Violence Against Civilians** also showed a continued correlation.\n:::\n\n## 3.8 KDE Limitation\n\n::: callout-important\n## KDE Limitation\n\n-   Since I am using `bw.ppl` for sigma, the bandwidth for each event type is adaptive. This creates a challenge when analyzing patterns across different event types and quarters. Sometimes, the KDE may not show many hotspots, even though the number of conflicts in that quarter is higher compared to another KDE with a wider spread of hotspots. ( As I observed that with a higher number on the scale bar, the KDE hotspots are fewer and more concentrated, while the KDE plot with a lower number on the scale bar shows more widespread hotspots.)\n:::\n\n# 4. Second-Order Spatial Point Pattern Analysis\n\nFor 2nd-order spatial point pattern analysis, each function(G,F,K,L) has their specific purpose:\n\n-   `G-function`: Measure the distribution of distance from random points to the nearest event points. Helps in understanding how clustered points are. E.g. 1 to 500 (**Commonly used**)\n\n-   `F-function`: Measures the distance from event points to random points. Complements the G-function, offering another way to detect clustering.\n\n-   `K-function`: Estimates the number of points within a given distance of each other, providing a more general measure of spatial interaction across multiple scales. E.g.1 to 10, 10 to 20 etc . (**Commonly used**)\n\n-   `L-function`: A linear transformation of the K-function that adjusts for boundary effects, making it easier to interpret by creating a straight line under complete spatial randomness.\n\n## 4.1 Choosing Function and Number of Simulations\n\nI want to find out that whether the conflict of the different event type that happen quarterly is evenly distributed or clustered. Since to compute for each event quarterly will need a long time to compute. Therefore, I will use `G-function` for the analysis, as compare to the other three functions, G-function tend to be faster and I will choose 200 for the number of simulations(Note the number of simulation start from 0, so I will use 199 for nsim).\n\n## 4.2 2021\n\n### 4.2.1 Q1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent_types <- c(\"Battles\", \"Explosions/Remote violence\", \"Strategic developments\", \"Violence against civilians\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  G_conflict <- acled_sf %>%\n    filter(event_type == event & year == 2021 & quarter == 1)\n  \n  # Convert to ppp format\n  G_conflict_ppp <- as.ppp(st_coordinates(G_conflict), st_bbox(G_conflict))\n  # Handle duplicated points\n  G_conflict_ppp <- rjitter(G_conflict_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n  # Extract event located within Myanmar\n  G_conflict_ppp = G_conflict_ppp[msrb_owin]\n  # Re-scale\n  G_conflict_ppp.km <- rescale(G_conflict_ppp, 1000, \"km\")\n  # Generate simulations\n  G_conflict.csr <- envelope(G_conflict_ppp.km, Gest, nsim = 199)\n  plot(G_conflict.csr, main = paste(event))\n}\n```\n:::\n\n\n![](website_files/2nd_order_msrb/2021Q1.png)\n\n### 4.2.2 Q2\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  G_conflict <- acled_sf %>%\n    filter(event_type == event & year == 2021 & quarter == 2)\n  \n  # Convert to ppp format\n  G_conflict_ppp <- as.ppp(st_coordinates(G_conflict), st_bbox(G_conflict))\n  # Handle duplicated points\n  G_conflict_ppp <- rjitter(G_conflict_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n  # Extract event located within Myanmar\n  G_conflict_ppp = G_conflict_ppp[msrb_owin]\n  # Re-scale\n  G_conflict_ppp.km <- rescale(G_conflict_ppp, 1000, \"km\")\n  # Generate simulations\n  G_conflict.csr <- envelope(G_conflict_ppp.km, Gest, nsim = 199)\n  plot(G_conflict.csr, main = paste(event))\n}\n```\n:::\n\n\n![](website_files/2nd_order_msrb/2021Q2.png)\n\n### 4.2.3 Q3\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  G_conflict <- acled_sf %>%\n    filter(event_type == event & year == 2021 & quarter == 3)\n  \n  # Convert to ppp format\n  G_conflict_ppp <- as.ppp(st_coordinates(G_conflict), st_bbox(G_conflict))\n  # Handle duplicated points\n  G_conflict_ppp <- rjitter(G_conflict_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n  # Extract event located within Myanmar\n  G_conflict_ppp = G_conflict_ppp[msrb_owin]\n  # Re-scale\n  G_conflict_ppp.km <- rescale(G_conflict_ppp, 1000, \"km\")\n  # Generate simulations\n  G_conflict.csr <- envelope(G_conflict_ppp.km, Gest, nsim = 199)\n  plot(G_conflict.csr, main = paste(event))\n}\n```\n:::\n\n\n![](website_files/2nd_order_msrb/2021Q3.png)\n\n### 4.2.4 Q4\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\n\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  G_conflict <- acled_sf %>%\n    filter(event_type == event & year == 2021 & quarter == 4)\n  \n  # Convert to ppp format\n  G_conflict_ppp <- as.ppp(st_coordinates(G_conflict), st_bbox(G_conflict))\n  # Handle duplicated points\n  G_conflict_ppp <- rjitter(G_conflict_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n  # Extract event located within Myanmar\n  G_conflict_ppp = G_conflict_ppp[msrb_owin]\n  # Re-scale\n  G_conflict_ppp.km <- rescale(G_conflict_ppp, 1000, \"km\")\n  # Generate simulations\n  G_conflict.csr <- envelope(G_conflict_ppp.km, Gest, nsim = 199)\n  plot(G_conflict.csr, main = paste(event))\n}\n```\n:::\n\n\n![](website_files/2nd_order_msrb/2021Q4.png)\n\n## 4.3 2022\n\n### 4.3.1 Q1\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\n\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  G_conflict <- acled_sf %>%\n    filter(event_type == event & year == 2022 & quarter == 1)\n  \n  # Convert to ppp format\n  G_conflict_ppp <- as.ppp(st_coordinates(G_conflict), st_bbox(G_conflict))\n  # Handle duplicated points\n  G_conflict_ppp <- rjitter(G_conflict_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n  # Extract event located within Myanmar\n  G_conflict_ppp = G_conflict_ppp[msrb_owin]\n  # Re-scale\n  G_conflict_ppp.km <- rescale(G_conflict_ppp, 1000, \"km\")\n  # Generate simulations\n  G_conflict.csr <- envelope(G_conflict_ppp.km, Gest, nsim = 199)\n  plot(G_conflict.csr, main = paste(event))\n}\n```\n:::\n\n\n![](website_files/2nd_order_msrb/2022Q1.png)\n\n### 4.3.2 Q2\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\n\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  G_conflict <- acled_sf %>%\n    filter(event_type == event & year == 2022 & quarter == 2)\n  \n  # Convert to ppp format\n  G_conflict_ppp <- as.ppp(st_coordinates(G_conflict), st_bbox(G_conflict))\n  # Handle duplicated points\n  G_conflict_ppp <- rjitter(G_conflict_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n  # Extract event located within Myanmar\n  G_conflict_ppp = G_conflict_ppp[msrb_owin]\n  # Re-scale\n  G_conflict_ppp.km <- rescale(G_conflict_ppp, 1000, \"km\")\n  # Generate simulations\n  G_conflict.csr <- envelope(G_conflict_ppp.km, Gest, nsim = 199)\n  plot(G_conflict.csr, main = paste(event))\n}\n```\n:::\n\n\n![](website_files/2nd_order_msrb/2022Q2.png)\n\n### 4.3.3 Q3\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\n\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  G_conflict <- acled_sf %>%\n    filter(event_type == event & year == 2022 & quarter == 3)\n  \n  # Convert to ppp format\n  G_conflict_ppp <- as.ppp(st_coordinates(G_conflict), st_bbox(G_conflict))\n  # Handle duplicated points\n  G_conflict_ppp <- rjitter(G_conflict_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n  # Extract event located within Myanmar\n  G_conflict_ppp = G_conflict_ppp[msrb_owin]\n  # Re-scale\n  G_conflict_ppp.km <- rescale(G_conflict_ppp, 1000, \"km\")\n  # Generate simulations\n  G_conflict.csr <- envelope(G_conflict_ppp.km, Gest, nsim = 199)\n  plot(G_conflict.csr, main = paste(event))\n}\n```\n:::\n\n\n![](website_files/2nd_order_msrb/2022Q3.png)\n\n### 4.3.4 Q4\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\n\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  G_conflict <- acled_sf %>%\n    filter(event_type == event & year == 2022 & quarter == 4)\n  \n  # Convert to ppp format\n  G_conflict_ppp <- as.ppp(st_coordinates(G_conflict), st_bbox(G_conflict))\n  # Handle duplicated points\n  G_conflict_ppp <- rjitter(G_conflict_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n  # Extract event located within Myanmar\n  G_conflict_ppp = G_conflict_ppp[msrb_owin]\n  # Re-scale\n  G_conflict_ppp.km <- rescale(G_conflict_ppp, 1000, \"km\")\n  # Generate simulations\n  G_conflict.csr <- envelope(G_conflict_ppp.km, Gest, nsim = 199)\n  plot(G_conflict.csr, main = paste(event))\n}\n```\n:::\n\n\n![](website_files/2nd_order_msrb/2022Q4.png)\n\n## 4.4 2023\n\n### 4.4.1 Q1\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\n\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  G_conflict <- acled_sf %>%\n    filter(event_type == event & year == 2023 & quarter == 1)\n  \n  # Convert to ppp format\n  G_conflict_ppp <- as.ppp(st_coordinates(G_conflict), st_bbox(G_conflict))\n  # Handle duplicated points\n  G_conflict_ppp <- rjitter(G_conflict_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n  # Extract event located within Myanmar\n  G_conflict_ppp = G_conflict_ppp[msrb_owin]\n  # Re-scale\n  G_conflict_ppp.km <- rescale(G_conflict_ppp, 1000, \"km\")\n  # Generate simulations\n  G_conflict.csr <- envelope(G_conflict_ppp.km, Gest, nsim = 199)\n  plot(G_conflict.csr, main = paste(event))\n}\n```\n:::\n\n\n![](website_files/2nd_order_msrb/2023Q1.png)\n\n### 4.4.2 Q2\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\n\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  G_conflict <- acled_sf %>%\n    filter(event_type == event & year == 2023 & quarter == 2)\n  \n  # Convert to ppp format\n  G_conflict_ppp <- as.ppp(st_coordinates(G_conflict), st_bbox(G_conflict))\n  # Handle duplicated points\n  G_conflict_ppp <- rjitter(G_conflict_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n  # Extract event located within Myanmar\n  G_conflict_ppp = G_conflict_ppp[msrb_owin]\n  # Re-scale\n  G_conflict_ppp.km <- rescale(G_conflict_ppp, 1000, \"km\")\n  # Generate simulations\n  G_conflict.csr <- envelope(G_conflict_ppp.km, Gest, nsim = 199)\n  plot(G_conflict.csr, main = paste(event))\n}\n```\n:::\n\n\n![](website_files/2nd_order_msrb/2023Q2.png)\n\n### 4.4.3 Q3\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\n\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  G_conflict <- acled_sf %>%\n    filter(event_type == event & year == 2023 & quarter == 3)\n  \n  # Convert to ppp format\n  G_conflict_ppp <- as.ppp(st_coordinates(G_conflict), st_bbox(G_conflict))\n  # Handle duplicated points\n  G_conflict_ppp <- rjitter(G_conflict_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n  # Extract event located within Myanmar\n  G_conflict_ppp = G_conflict_ppp[msrb_owin]\n  # Re-scale\n  G_conflict_ppp.km <- rescale(G_conflict_ppp, 1000, \"km\")\n  # Generate simulations\n  G_conflict.csr <- envelope(G_conflict_ppp.km, Gest, nsim = 199)\n  plot(G_conflict.csr, main = paste(event))\n}\n```\n:::\n\n\n![](website_files/2nd_order_msrb/2023Q3.png)\n\n### 4.4.4 Q4\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\n\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  G_conflict <- acled_sf %>%\n    filter(event_type == event & year == 2023 & quarter == 4)\n  \n  # Convert to ppp format\n  G_conflict_ppp <- as.ppp(st_coordinates(G_conflict), st_bbox(G_conflict))\n  # Handle duplicated points\n  G_conflict_ppp <- rjitter(G_conflict_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n  # Extract event located within Myanmar\n  G_conflict_ppp = G_conflict_ppp[msrb_owin]\n  # Re-scale\n  G_conflict_ppp.km <- rescale(G_conflict_ppp, 1000, \"km\")\n  # Generate simulations\n  G_conflict.csr <- envelope(G_conflict_ppp.km, Gest, nsim = 199)\n  plot(G_conflict.csr, main = paste(event))\n}\n```\n:::\n\n\n![](website_files/2nd_order_msrb/2023Q4.png)\n\n## 4.5 2024\n\n### 4.5.1 Q1\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\n\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  G_conflict <- acled_sf %>%\n    filter(event_type == event & year == 2024 & quarter == 1)\n  \n  # Convert to ppp format\n  G_conflict_ppp <- as.ppp(st_coordinates(G_conflict), st_bbox(G_conflict))\n  # Handle duplicated points\n  G_conflict_ppp <- rjitter(G_conflict_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n  # Extract event located within Myanmar\n  G_conflict_ppp = G_conflict_ppp[msrb_owin]\n  # Re-scale\n  G_conflict_ppp.km <- rescale(G_conflict_ppp, 1000, \"km\")\n  # Generate simulations\n  G_conflict.csr <- envelope(G_conflict_ppp.km, Gest, nsim = 199)\n  plot(G_conflict.csr, main = paste(event))\n}\n```\n:::\n\n\n![](website_files/2nd_order_msrb/2024Q1.png)\n\n### 4.5.2 Q2\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\n\n# Create a plot for each event type\nfor (event in event_types) {\n  # Filter data by event type\n  G_conflict <- acled_sf %>%\n    filter(event_type == event & year == 2024 & quarter == 2)\n  \n  # Convert to ppp format\n  G_conflict_ppp <- as.ppp(st_coordinates(G_conflict), st_bbox(G_conflict))\n  # Handle duplicated points\n  G_conflict_ppp <- rjitter(G_conflict_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n  # Extract event located within Myanmar\n  G_conflict_ppp = G_conflict_ppp[msrb_owin]\n  # Re-scale\n  G_conflict_ppp.km <- rescale(G_conflict_ppp, 1000, \"km\")\n  # Generate simulations\n  G_conflict.csr <- envelope(G_conflict_ppp.km, Gest, nsim = 199)\n  plot(G_conflict.csr, main = paste(event))\n}\n```\n:::\n\n\n![](website_files/2nd_order_msrb/2024Q2.png)\n\n## 4.6 Insight\n\n::: callout-tip\n## 2nd Order Spatial Point Pattern Analysis Insight\n\n-   From the quarterly plots, the observed line in most cases lies above the envelope, indicating clustering in the conflict locations. An exception is seen in **2021 Q1**, where the plot for **violence against civilians** shows the observed line entering the envelope toward the end.\n\n-   Overall, this confirms that the spatial patterns for all four event types exhibit clustering over the years.\n:::\n\n## 4.7 Further into the Hot Conflict Region\n\nAs observed in the G function graph for the whole of Myanmar, the plots are quite similar, providing limited insight into the conflict patterns. Therefore, based on the KDE generated in Section 3, I have chosen to focus on the central region, where most of the conflicts occur, specifically in Magway State, Mandalay State, and Sagaing State. To check whether the G-function graph within the 3 state will be able to provide any useful insight of the patterns.\n\nTo read the RDS file.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmsrb_sub_reg <- read_rds(\"data/rds/msrb_sub_reg.rds\")\nacled_sf <- read_rds(\"data/rds/acled_sf.rds\")\n```\n:::\n\n\nTo filter out the three state.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nselected_states <- msrb_sub_reg %>%\n  filter(state_name %in% c(\"Magway\", \"Mandalay\", \"Sagaing\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nconflcit_within_states <- st_intersection(acled_sf, selected_states)\n```\n:::\n\n\nTo write and read the data in RDS format.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n write_rds(conflcit_within_states,\"data/rds/conflcit_within_states.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nconflcit_within_states <- read_rds(\"data/rds/conflcit_within_states.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnrow(acled_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 51553\n```\n\n\n:::\n\n```{.r .cell-code}\nnrow(conflcit_within_states)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 23675\n```\n\n\n:::\n:::\n\n\nWe can see that nearly 50% of the conflicts occurred within the three states over the period.\n\nLets to have a quite look of the plot.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ntm1 <- tm_shape(selected_states) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\n  tm_text(\"state_name\", size = 1, col = \"blue\")\n\ntm2 <- tm_shape(selected_states) +\n  tm_borders(alpha = 1, col = \"red\") +\n  tm_polygons() +\n  tm_shape(conflcit_within_states)+\n  tm_dots()\n\ntmap_arrange(tm1, tm2, ncol = 2)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-70-1.png){width=1152}\n:::\n:::\n\n\nThe below chunk is to create owin object of the selected states.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nselected_states_owin <- as.owin(selected_states)\n```\n:::\n\n\nAs when I plot out the sample G-function plot, the observed line and the theoretical line are very far. Therefore I will use a low **nsim** (number of simulations) to speed up the computation and examine the pattern for each quarter.\n\n::: panel-tabset\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\n\nyears <- 2021:2024\nquarters <- c(1, 2, 3, 4) \nquarters_2024 <- c(1, 2) \nfor (year in years) {\n  # Determine the quarters to loop through for each year\n  if (year == 2024) {\n    quarters_to_use <- quarters_2024\n  } else {\n    quarters_to_use <- quarters\n  }\n  \n  # Loop through each quarter\n  for (quarter in quarters_to_use) {\n    # Filter data based on the current year and quarter\n    filtered_data <- conflcit_within_states %>%\n      filter(event_type == \"Battles\" & year == year & quarter == quarter)\n    \n    # Convert to ppp format\n    G_conflict_ppp <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n    # Handle duplicated points\n    G_conflict_ppp <- rjitter(G_conflict_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n    # Extract event located within the selected state\n    G_conflict_ppp = G_conflict_ppp[selected_states_owin]\n    # Re-scale\n    G_conflict_ppp.km <- rescale(G_conflict_ppp, 1000, \"km\")\n    # Generate simulations\n    G_conflict.csr <- envelope(G_conflict_ppp.km, Gest, nsim = 3)\n    plot(G_conflict.csr, main = paste(\"Battles G function - \", year, \" Q\", quarter))\n  }\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-72-1.png){width=1152}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-72-2.png){width=1152}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-72-3.png){width=1152}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-72-4.png){width=1152}\n:::\n:::\n\n\n## Explosions/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\n\nyears <- 2021:2024\nquarters <- c(1, 2, 3, 4) \nquarters_2024 <- c(1, 2) \nfor (year in years) {\n  # Determine the quarters to loop through for each year\n  if (year == 2024) {\n    quarters_to_use <- quarters_2024\n  } else {\n    quarters_to_use <- quarters\n  }\n  \n  # Loop through each quarter\n  for (quarter in quarters_to_use) {\n    # Filter data based on the current year and quarter\n    filtered_data <- conflcit_within_states %>%\n      filter(event_type == \"Explosions/Remote violence\" & year == year & quarter == quarter)\n    \n    # Convert to ppp format\n    G_conflict_ppp <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n    # Handle duplicated points\n    G_conflict_ppp <- rjitter(G_conflict_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n    # Extract event located within the selected state\n    G_conflict_ppp = G_conflict_ppp[selected_states_owin]\n    # Re-scale\n    G_conflict_ppp.km <- rescale(G_conflict_ppp, 1000, \"km\")\n    # Generate simulations\n    G_conflict.csr <- envelope(G_conflict_ppp.km, Gest, nsim = 3)\n    plot(G_conflict.csr, main = paste(\"Explosions/Remote violence G function - \", year, \" Q\", quarter))\n  }\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-73-1.png){width=1152}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-73-2.png){width=1152}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-73-3.png){width=1152}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-73-4.png){width=1152}\n:::\n:::\n\n\n## Strategic developments\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\n\nyears <- 2021:2024\nquarters <- c(1, 2, 3, 4) \nquarters_2024 <- c(1, 2) \nfor (year in years) {\n  # Determine the quarters to loop through for each year\n  if (year == 2024) {\n    quarters_to_use <- quarters_2024\n  } else {\n    quarters_to_use <- quarters\n  }\n  \n  # Loop through each quarter\n  for (quarter in quarters_to_use) {\n    # Filter data based on the current year and quarter\n    filtered_data <- conflcit_within_states %>%\n      filter(event_type == \"Strategic developments\" & year == year & quarter == quarter)\n    \n    # Convert to ppp format\n    G_conflict_ppp <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n    # Handle duplicated points\n    G_conflict_ppp <- rjitter(G_conflict_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n    # Extract event located within the selected state\n    G_conflict_ppp = G_conflict_ppp[selected_states_owin]\n    # Re-scale\n    G_conflict_ppp.km <- rescale(G_conflict_ppp, 1000, \"km\")\n    # Generate simulations\n    G_conflict.csr <- envelope(G_conflict_ppp.km, Gest, nsim = 3)\n    plot(G_conflict.csr, main = paste(\"Strategic developments G function - \", year, \" Q\", quarter))\n  }\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-74-1.png){width=1152}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-74-2.png){width=1152}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-74-3.png){width=1152}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-74-4.png){width=1152}\n:::\n:::\n\n\n## Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\n\nyears <- 2021:2024\nquarters <- c(1, 2, 3, 4) \nquarters_2024 <- c(1, 2) \nfor (year in years) {\n  # Determine the quarters to loop through for each year\n  if (year == 2024) {\n    quarters_to_use <- quarters_2024\n  } else {\n    quarters_to_use <- quarters\n  }\n  \n  # Loop through each quarter\n  for (quarter in quarters_to_use) {\n    # Filter data based on the current year and quarter\n    filtered_data <- conflcit_within_states %>%\n      filter(event_type == \"Violence against civilians\" & year == year & quarter == quarter)\n    \n    # Convert to ppp format\n    G_conflict_ppp <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n    # Handle duplicated points\n    G_conflict_ppp <- rjitter(G_conflict_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n    # Extract event located within the selected state\n    G_conflict_ppp = G_conflict_ppp[selected_states_owin]\n    # Re-scale\n    G_conflict_ppp.km <- rescale(G_conflict_ppp, 1000, \"km\")\n    # Generate simulations\n    G_conflict.csr <- envelope(G_conflict_ppp.km, Gest, nsim = 3)\n    plot(G_conflict.csr, main = paste(\"Violence against civilians G function - \", year, \" Q\", quarter))\n  }\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-75-1.png){width=1152}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-75-2.png){width=1152}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-75-3.png){width=1152}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 3 simulations of CSR  ...\n1, 2, \n3.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-75-4.png){width=1152}\n:::\n:::\n\n:::\n\n### 4.7.1 Insight\n\n::: callout-note\n## Selected State Insight\n\n-   Despite analyzing the G-function plots for each event type on a quarterly basis within the selected states, the resulting plots resemble those of the entire Myanmar. This suggests that the spatial distribution of conflicts remains consistent across different quarters.\n:::\n\n# 5. Spatio-temporal KDE\n\n## 5.1 Prepare the Data\n\nTo read **acled_sf** from RDS.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- read_rds( \"data/rds/acled_sf.rds\")\n```\n:::\n\n\nTo only select the necessary fields to save memory and create a year_quarter field ,make it as factors for later to plot the graph.\n\n::: callout-note\nyear_quarter need to be in numeric in order to compute STDKE.\n\n-   2021 Q1 =\\> 2021.00\n\n-   2021 Q2 =\\> 2021.25\n\n-   2021 Q3 =\\> 2021.50\n\n-   2021 Q4 =\\> 2021.75\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- acled_sf %>%\n  mutate(year_quarter = round(year + (quarter - 1) / 4, 2) )\n```\n:::\n\n\nTo filter the data based on **event_type**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbattles_sf <- acled_sf %>%\n    filter(event_type == \"Battles\")\n\nexplosions_sf <- acled_sf %>%\n    filter(event_type == \"Explosions/Remote violence\")\n\nstrategic_sf <- acled_sf %>%\n    filter(event_type == \"Strategic developments\") \n\ncivilians_sf <- acled_sf %>%\n    filter(event_type == \"Violence against civilians\") \n```\n:::\n\n\nSave the Data into rds.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(acled_sf, \"data/rds/acled_sf.rds\") # to update the RDS file\nwrite_rds(battles_sf, \"data/rds/battles_sf.rds\")\nwrite_rds(explosions_sf, \"data/rds/explosions_sf.rds\")\nwrite_rds(strategic_sf, \"data/rds/strategic_sf.rds\")\nwrite_rds(civilians_sf, \"data/rds/civilians_sf.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfiltered_msrb <- read_rds(\"data/rds/filtered_msrb.rds\")\nbattles_sf <- read_rds(\"data/rds/battles_sf.rds\")\nexplosions_sf <- read_rds(\"data/rds/explosions_sf.rds\")\nstrategic_sf <- read_rds(\"data/rds/strategic_sf.rds\")\ncivilians_sf <- read_rds(\"data/rds/civilians_sf.rds\")\n```\n:::\n\n\n## 5.2 Overview\n\nUsing `tmap` packages to plot over 2021 to 2024.\n\n::: panel-tabset\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(filtered_msrb) +\n  tm_polygons() +\n  tm_shape(battles_sf) +\n  tm_dots()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-81-1.png){width=1152}\n:::\n:::\n\n\n## Explosions/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(filtered_msrb) +\n  tm_polygons() +\n  tm_shape(explosions_sf) +\n  tm_dots()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-82-1.png){width=1152}\n:::\n:::\n\n\n## Strategic developments\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(filtered_msrb) +\n  tm_polygons() +\n  tm_shape(strategic_sf) +\n  tm_dots()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-83-1.png){width=1152}\n:::\n:::\n\n\n## Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(filtered_msrb) +\n  tm_polygons() +\n  tm_shape(civilians_sf) +\n  tm_dots()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-84-1.png){width=1152}\n:::\n:::\n\n:::\n\n## 5.3 Visualizing Distribution of Conflict by Quarter\n\n::: panel-tabset\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ntm_shape(filtered_msrb) +\n  tm_polygons() +\n  tm_shape(battles_sf) +\n  tm_dots(size = 0.1) +\n  tm_facets(by=\"year_quarter\",\n            free.coords = FALSE, # To avoid the zoom issue of the display map\n            drop.units = TRUE,\n            nrow = 4)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-85-1.png){width=576}\n:::\n:::\n\n\n## Explosions/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ntm_shape(filtered_msrb) +\n  tm_polygons() +\n  tm_shape(explosions_sf) +\n  tm_dots(size = 0.1) +\n  tm_facets(by=\"year_quarter\",\n            free.coords = FALSE, # To avoid the zoom issue of the display map\n            drop.units = TRUE,\n            nrow = 4)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-86-1.png){width=576}\n:::\n:::\n\n\n## Strategic developments\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ntm_shape(filtered_msrb) +\n  tm_polygons() +\n  tm_shape(strategic_sf) +\n  tm_dots(size = 0.1) +\n  tm_facets(by=\"year_quarter\",\n            free.coords = FALSE, # To avoid the zoom issue of the display map\n            drop.units = TRUE,\n            nrow = 4)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-87-1.png){width=576}\n:::\n:::\n\n\n## Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ntm_shape(filtered_msrb) +\n  tm_polygons() +\n  tm_shape(civilians_sf) +\n  tm_dots(size = 0.1) +\n  tm_facets(by=\"year_quarter\",\n            free.coords = FALSE, # To avoid the zoom issue of the display map\n            drop.units = TRUE,\n            nrow = 4)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-88-1.png){width=576}\n:::\n:::\n\n:::\n\n## 5.3 Computing STDKE by Quarter\n\n### 5.3.1 Creating ppp object.\n\nRemove unwanted fields. As ppp object only need mark field and geometry field from the data frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbattles_quarter <- battles_sf %>%\n  dplyr::select(year_quarter)\n\nexplosions_quarter <- explosions_sf %>%\n  dplyr::select(year_quarter)\n\nstrategic_quarter <- strategic_sf %>%\n  dplyr::select(year_quarter)\n\ncivilians_quarter <- civilians_sf %>%\n  dplyr::select(year_quarter)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbattles_quarter_ppp <- as.ppp(battles_quarter)\nexplosions_quarter_ppp <- as.ppp(explosions_quarter)\nstrategic_quarter_ppp <- as.ppp(strategic_quarter)\ncivilians_quarter_ppp <- as.ppp(civilians_quarter)\n```\n:::\n\n\nCheck if there is duplicated point.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nany(duplicated(battles_quarter_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nany(duplicated(explosions_quarter_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nany(duplicated(strategic_quarter_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nany(duplicated(civilians_quarter_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n:::\n\n\nHandle duplicated points.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbattles_quarter_ppp <- rjitter(battles_quarter_ppp, retry = TRUE, nsim = 1, drop = TRUE)\nexplosions_quarter_ppp <- rjitter(explosions_quarter_ppp, retry = TRUE, nsim = 1, drop = TRUE)\nstrategic_quarter_ppp <- rjitter(strategic_quarter_ppp, retry = TRUE, nsim = 1, drop = TRUE)\ncivilians_quarter_ppp <- rjitter(civilians_quarter_ppp, retry = TRUE, nsim = 1, drop = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nany(duplicated(battles_quarter_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n\n```{.r .cell-code}\nany(duplicated(explosions_quarter_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n\n```{.r .cell-code}\nany(duplicated(strategic_quarter_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n\n```{.r .cell-code}\nany(duplicated(civilians_quarter_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n:::\n\n\nWrite the **ppp** object into RDS file, so that we can re-use them without running all the above steps again.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(battles_quarter_ppp, \"data/rds/battles_quarter_ppp.rds\")\nwrite_rds(explosions_quarter_ppp, \"data/rds/explosions_quarter_ppp.rds\")\nwrite_rds(strategic_quarter_ppp, \"data/rds/strategic_quarter_ppp.rds\")\nwrite_rds(civilians_quarter_ppp, \"data/rds/civilians_quarter_ppp.rds\")\n```\n:::\n\n\n### 5.3.2 Including Owin object\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmsrb_owin <- as.owin(filtered_msrb)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbattles_quarter_owin <- battles_quarter_ppp[msrb_owin]\nexplosions_quarter_owin <- explosions_quarter_ppp[msrb_owin]\nstrategic_quarter_owin <- strategic_quarter_ppp[msrb_owin]\ncivilians_quarter_owin <- civilians_quarter_ppp[msrb_owin]\n# summary(battles_quarter_owin)\n```\n:::\n\n\n### 5.3.3 Compute STKDE for Events\n\nCompute STKDE for battles event.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Re-scale\nbattles_quarter_owin.km <- rescale(battles_quarter_owin, 1000, \"km\")\nbattles_st_kde <- spattemp.density(battles_quarter_owin.km)\nsummary(battles_st_kde)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 56.7339 (spatial)\n  lambda = 0.0033 (temporal)\n\nNo. of observations\n  11970 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [-210.0086, 724.6476] x [1087.92, 3158.467]\n\nTemporal bound\n  [2021, 2025]\n\nEvaluation\n  128 x 128 x 5 trivariate lattice\n  Density range: [0, 0.0001031669]\n```\n\n\n:::\n:::\n\n\nExplosions/remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Re-scale\nexplosions_quarter_owin.km <- rescale(explosions_quarter_owin, 1000, \"km\")\nexplosions_st_kde <- spattemp.density(explosions_quarter_owin.km)\nsummary(explosions_st_kde)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 53.3839 (spatial)\n  lambda = 0.0032 (temporal)\n\nNo. of observations\n  12117 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [-210.0086, 724.6476] x [1087.92, 3158.467]\n\nTemporal bound\n  [2021, 2025]\n\nEvaluation\n  128 x 128 x 5 trivariate lattice\n  Density range: [0, 0.0001419946]\n```\n\n\n:::\n:::\n\n\nStrategic Developments\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Re-scale\nstrategic_quarter_owin.km <- rescale(strategic_quarter_owin, 1000, \"km\")\nstrategic_st_kde <- spattemp.density(strategic_quarter_owin.km)\nsummary(strategic_st_kde)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 52.5751 (spatial)\n  lambda = 0.0032 (temporal)\n\nNo. of observations\n  12028 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [-210.0086, 724.6476] x [1087.92, 3158.467]\n\nTemporal bound\n  [2021, 2025]\n\nEvaluation\n  128 x 128 x 5 trivariate lattice\n  Density range: [0, 0.0001335652]\n```\n\n\n:::\n:::\n\n\nViolence Against Civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Re-scale\ncivilians_quarter_owin.km <- rescale(civilians_quarter_owin, 1000, \"km\")\ncivilians_st_kde <- spattemp.density(civilians_quarter_owin.km)\nsummary(civilians_st_kde)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 59.8258 (spatial)\n  lambda = 0.0054 (temporal)\n\nNo. of observations\n  6170 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [-210.0086, 724.6476] x [1087.92, 3158.467]\n\nTemporal bound\n  [2021, 2025]\n\nEvaluation\n  128 x 128 x 5 trivariate lattice\n  Density range: [0, 6.598748e-05]\n```\n\n\n:::\n:::\n\n\n### 5.3.4 STDKE Plot\n\nCreate variables for later use. Mainly **times** for the time field for STKDE and **time_labels** for the naming of the plot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntimes <- seq(2021.00, 2024.25, by = 0.25)\ntime_labels <- sapply(times, function(t) {\n  year <- floor(t)\n  quarter <- ((t - year) * 4) + 1\n  paste(year, \" Q\", quarter, sep = \"\")\n})\n```\n:::\n\n\n::: panel-tabset\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nfor(i in seq_along(times)){\n  plot(battles_st_kde, times[i] ,\n       override.par=FALSE,\n       fix.range=TRUE,\n       main=paste(\"Battles STKDE in \",time_labels[i])\n       )\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-102-1.png){width=1152}\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-102-2.png){width=1152}\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-102-3.png){width=1152}\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-102-4.png){width=1152}\n:::\n:::\n\n\n## Explosions/Remote Violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nfor(i in seq_along(times)){\n  plot(explosions_st_kde, times[i] ,\n       override.par=FALSE,\n       fix.range=TRUE,\n       main=paste(\"Explosions/Remote Violence STKDE in \",time_labels[i])\n       )\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-103-1.png){width=1152}\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-103-2.png){width=1152}\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-103-3.png){width=1152}\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-103-4.png){width=1152}\n:::\n:::\n\n\n## Strategic Developments\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nfor(i in seq_along(times)){\n  plot(strategic_st_kde, times[i] ,\n       override.par=FALSE,\n       fix.range=TRUE,\n       main=paste(\"Strategic Developments STKDE in \",time_labels[i])\n       )\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-104-1.png){width=1152}\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-104-2.png){width=1152}\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-104-3.png){width=1152}\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-104-4.png){width=1152}\n:::\n:::\n\n\n## Violence Against Civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nfor(i in seq_along(times)){\n  plot(civilians_st_kde, times[i] ,\n       override.par=FALSE,\n       fix.range=TRUE,\n       main=paste(\"Violence Against Civilians STKDE in \",time_labels[i])\n       )\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-105-1.png){width=1152}\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-105-2.png){width=1152}\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-105-3.png){width=1152}\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-105-4.png){width=1152}\n:::\n:::\n\n:::\n\n### 5.3.5 Animate the Plot\n\nTo better visualize the spatial-temporal KDE plot, I will use `magick` package in R to convert a sequence of PNG images into a dynamic GIF. Each PNG file represents spatial-temporal KDE plots for different quarters, and I am combining them into an animated GIF that visually depicts changes in data over time. The `magick` package allows me to handle and manipulate these images seamlessly, and I am setting parameters like the frame rate (fps) to control the speed of the animation.\n\n::: panel-tabset\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nfor(i in seq_along(times)){\n   # Define the file path\n  file_path <- paste0(\"data/images/\", time_labels[i], \"_Battles.png\")\n  \n  # Open a PNG device\n  png(file_path, width = 800, height = 600)\n  plot(battles_st_kde, times[i] ,\n       override.par=FALSE,\n       fix.range=TRUE,\n       main=paste(\"Battles STKDE in \",time_labels[i])\n       )\n  dev.off()\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nimage_files <- list.files(\"data/images/\", pattern = \"_Battles\\\\.png\", full.names = TRUE)\nimage_files <- sort(image_files) \n# Read images into a list\nimages <- image_read(image_files)\n\n# Create an animation\nanimation <- image_animate(images, fps = 1)\n\n# Display the animation\nprint(animation)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 14 × 7\n   format width height colorspace matte filesize density\n   <chr>  <int>  <int> <chr>      <lgl>    <int> <chr>  \n 1 gif      800    600 sRGB       TRUE         0 72x72  \n 2 gif      800    600 sRGB       TRUE         0 72x72  \n 3 gif      800    600 sRGB       TRUE         0 72x72  \n 4 gif      800    600 sRGB       TRUE         0 72x72  \n 5 gif      800    600 sRGB       TRUE         0 72x72  \n 6 gif      800    600 sRGB       TRUE         0 72x72  \n 7 gif      800    600 sRGB       TRUE         0 72x72  \n 8 gif      800    600 sRGB       TRUE         0 72x72  \n 9 gif      800    600 sRGB       TRUE         0 72x72  \n10 gif      800    600 sRGB       TRUE         0 72x72  \n11 gif      800    600 sRGB       TRUE         0 72x72  \n12 gif      800    600 sRGB       TRUE         0 72x72  \n13 gif      800    600 sRGB       TRUE         0 72x72  \n14 gif      800    600 sRGB       TRUE         0 72x72  \n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-107-1.gif)\n:::\n:::\n\n\n## Explosions/Remote Violence\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nfor(i in seq_along(times)){\n   # Define the file path\n  file_path <- paste0(\"data/images/\", time_labels[i], \"_Explosions.png\")\n  \n  # Open a PNG device\n  png(file_path, width = 800, height = 600)\n  plot(explosions_st_kde, times[i] ,\n       override.par=FALSE,\n       fix.range=TRUE,\n       main=paste(\"Explosions/Remote Violence STKDE in \",time_labels[i])\n       )\n  dev.off()\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nimage_files <- list.files(\"data/images/\", pattern = \"_Explosions\\\\.png\", full.names = TRUE)\nimage_files <- sort(image_files) \n# Read images into a list\nimages <- image_read(image_files)\n\n# Create an animation\nanimation <- image_animate(images, fps = 1)\n\n# Display the animation\nprint(animation)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 14 × 7\n   format width height colorspace matte filesize density\n   <chr>  <int>  <int> <chr>      <lgl>    <int> <chr>  \n 1 gif      800    600 sRGB       TRUE         0 72x72  \n 2 gif      800    600 sRGB       TRUE         0 72x72  \n 3 gif      800    600 sRGB       TRUE         0 72x72  \n 4 gif      800    600 sRGB       TRUE         0 72x72  \n 5 gif      800    600 sRGB       TRUE         0 72x72  \n 6 gif      800    600 sRGB       TRUE         0 72x72  \n 7 gif      800    600 sRGB       TRUE         0 72x72  \n 8 gif      800    600 sRGB       TRUE         0 72x72  \n 9 gif      800    600 sRGB       TRUE         0 72x72  \n10 gif      800    600 sRGB       TRUE         0 72x72  \n11 gif      800    600 sRGB       TRUE         0 72x72  \n12 gif      800    600 sRGB       TRUE         0 72x72  \n13 gif      800    600 sRGB       TRUE         0 72x72  \n14 gif      800    600 sRGB       TRUE         0 72x72  \n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-109-1.gif)\n:::\n:::\n\n\n## Strategic Developments\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nfor(i in seq_along(times)){\n   # Define the file path\n  file_path <- paste0(\"data/images/\", time_labels[i], \"_Strategic.png\")\n  \n  # Open a PNG device\n  png(file_path, width = 800, height = 600)\n  plot(explosions_st_kde, times[i] ,\n       override.par=FALSE,\n       fix.range=TRUE,\n       main=paste(\"Strategic Developments STKDE in \",time_labels[i])\n       )\n  dev.off()\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nimage_files <- list.files(\"data/images/\", pattern = \"_Strategic\\\\.png\", full.names = TRUE)\nimage_files <- sort(image_files) \n# Read images into a list\nimages <- image_read(image_files)\n\n# Create an animation\nanimation <- image_animate(images, fps = 1)\n\n# Display the animation\nprint(animation)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 14 × 7\n   format width height colorspace matte filesize density\n   <chr>  <int>  <int> <chr>      <lgl>    <int> <chr>  \n 1 gif      800    600 sRGB       TRUE         0 72x72  \n 2 gif      800    600 sRGB       TRUE         0 72x72  \n 3 gif      800    600 sRGB       TRUE         0 72x72  \n 4 gif      800    600 sRGB       TRUE         0 72x72  \n 5 gif      800    600 sRGB       TRUE         0 72x72  \n 6 gif      800    600 sRGB       TRUE         0 72x72  \n 7 gif      800    600 sRGB       TRUE         0 72x72  \n 8 gif      800    600 sRGB       TRUE         0 72x72  \n 9 gif      800    600 sRGB       TRUE         0 72x72  \n10 gif      800    600 sRGB       TRUE         0 72x72  \n11 gif      800    600 sRGB       TRUE         0 72x72  \n12 gif      800    600 sRGB       TRUE         0 72x72  \n13 gif      800    600 sRGB       TRUE         0 72x72  \n14 gif      800    600 sRGB       TRUE         0 72x72  \n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-111-1.gif)\n:::\n:::\n\n\n## Violence Against Civilians\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nfor(i in seq_along(times)){\n   # Define the file path\n  file_path <- paste0(\"data/images/\", time_labels[i], \"_Civilians.png\")\n  \n  # Open a PNG device\n  png(file_path, width = 800, height = 600)\n  plot(explosions_st_kde, times[i] ,\n       override.par=FALSE,\n       fix.range=TRUE,\n       main=paste(\"Violence Against Civilians STKDE in \",time_labels[i])\n       )\n  dev.off()\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nimage_files <- list.files(\"data/images/\", pattern = \"_Civilians\\\\.png\", full.names = TRUE)\nimage_files <- sort(image_files) \n# Read images into a list\nimages <- image_read(image_files)\n\n# Create an animation\nanimation <- image_animate(images, fps = 1)\n\n# Display the animation\nprint(animation)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 14 × 7\n   format width height colorspace matte filesize density\n   <chr>  <int>  <int> <chr>      <lgl>    <int> <chr>  \n 1 gif      800    600 sRGB       TRUE         0 72x72  \n 2 gif      800    600 sRGB       TRUE         0 72x72  \n 3 gif      800    600 sRGB       TRUE         0 72x72  \n 4 gif      800    600 sRGB       TRUE         0 72x72  \n 5 gif      800    600 sRGB       TRUE         0 72x72  \n 6 gif      800    600 sRGB       TRUE         0 72x72  \n 7 gif      800    600 sRGB       TRUE         0 72x72  \n 8 gif      800    600 sRGB       TRUE         0 72x72  \n 9 gif      800    600 sRGB       TRUE         0 72x72  \n10 gif      800    600 sRGB       TRUE         0 72x72  \n11 gif      800    600 sRGB       TRUE         0 72x72  \n12 gif      800    600 sRGB       TRUE         0 72x72  \n13 gif      800    600 sRGB       TRUE         0 72x72  \n14 gif      800    600 sRGB       TRUE         0 72x72  \n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-113-1.gif)\n:::\n:::\n\n:::\n\n### 5.3.6 Insights\n\n::: callout-tip\n## STKDE Insights\n\n-   In term of conflict density, we can see that for all four event types, conflicts are primarily occur at the central regions (boundary between Sagaing State, Magway State and Mandalay Sate ) and southern regions(Yangon State, Mon State and Kayin State)\n\n-   As for conflict intensity over the years. We can see that the pattern are similar for the four event types. The intensity increasing start from 2021 Q1 and reach peak in 2022 Q4, and then shows a declining trend from 2023 through 2024 Q2.\n\n-   In terms of the correlation between event types, **battles** and **explosions/remote violence** are more closely related, particularly in the southern regions, where the density patterns for both event types are quite similar. On the other hand, **strategic developments** and **violence against civilians** are more aligned with each other, as their patterns and densities show similar trends over the same period.\n:::\n\n## 5.4 Exploring using tmap functions\n\nI am using a fixed bandwidth of 50km instead of a dynamic one (like bw.ppl). By employing a fixed bandwidth, the smoothing is uniform across the entire area, ensuring consistent density representation across different quarters.\n\nIn this section, I am not rechecking for duplicate points in the **ppp** object, as the issue with duplicates was already addressed and resolved in section 5.1.\n\nI will be using continuous style (style = \"cont\" ) to plot the tmap, as compare with other style, continuous style give me the most smooth representation of the density.\n\nExample of using default style.\n\n![](website_files/gif/battles_conflict_density_animation_default.gif)\n\n::: panel-tabset\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ntimes <- seq(2021.00, 2024.25, by = 0.25)  # From 2021 Q1 to 2024 Q2\ntime_labels <- sapply(times, function(t) {\n  year <- floor(t)\n  quarter <- ((t - year) * 4) + 1\n  paste(year, \"Q\", quarter, sep = \"\")\n})\n# Create an empty vector to store density values and list to store the KDE layers\nall_densities <- c()\ndensities <- list()\n\nfor (i in seq_along(times)) {\n  conflict_ppp <- battles_quarter_ppp[battles_quarter$year_quarter == times[i]]\n  conflict_ppp <- conflict_ppp[msrb_owin]\n  conflict_ppp.km <- rescale(conflict_ppp, 1000, \"km\")\n  density <- density(conflict_ppp.km, sigma = 50, edge = TRUE)\n  \n  # Convert density to raster and extract values\n  kde_raster <- raster(density)\n  projection(kde_raster) <- CRS(\"+init=EPSG:3414\")\n  \n  # Extract density values and add to all_densities\n  all_densities <- c(all_densities, values(kde_raster))\n  densities[[i]] <- kde_raster\n}\n\nmax_density <- max(all_densities, na.rm = TRUE)\n\n# Create an empty list to store the tmap objects\ntmaps <- list()\n# Loop through each time period, create the KDE map, and add it to the list\nfor (i in seq_along(times)) {\n  tm <- tm_shape(densities[[i]] ) +\n    tm_raster(palette = \"YlOrRd\", \n              title = \"Conflict Density\",\n              style = \"cont\",\n              breaks = seq(0, max_density, length.out = 5)) +\n    tm_layout(title = paste(\"Battles Conflict Density - \", time_labels[i]),\n              legend.position = c(\"left\", \"bottom\"), \n              frame = FALSE)\n\n  # Add the tmap object to the list\n  tmaps[[i]] <- tm\n}\ntmap_animation(tmaps, filename = \"website_files/gif/battles_conflict_density_animation.gif\", delay = 100, width = 800, height = 600)\n```\n:::\n\n\n![](website_files/gif/battles_conflict_density_animation.gif)\n\n## Explosions/Remote Violence\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ntimes <- seq(2021.00, 2024.25, by = 0.25)  # From 2021 Q1 to 2024 Q2\ntime_labels <- sapply(times, function(t) {\n  year <- floor(t)\n  quarter <- ((t - year) * 4) + 1\n  paste(year, \"Q\", quarter, sep = \"\")\n})\n# Create an empty vector to store density values and list to store the KDE layers\nall_densities <- c()\ndensities <- list()\n\nfor (i in seq_along(times)) {\n  conflict_ppp <- explosions_quarter_ppp[explosions_quarter$year_quarter == times[i]]\n  conflict_ppp <- conflict_ppp[msrb_owin]\n  conflict_ppp.km <- rescale(conflict_ppp, 1000, \"km\")\n  density <- density(conflict_ppp.km, sigma = 50, edge = TRUE)\n  \n  # Convert density to raster and extract values\n  kde_raster <- raster(density)\n  projection(kde_raster) <- CRS(\"+init=EPSG:3414\")\n  \n  # Extract density values and add to all_densities\n  all_densities <- c(all_densities, values(kde_raster))\n  densities[[i]] <- kde_raster\n}\n\nmax_density <- max(all_densities, na.rm = TRUE)\n\n# Create an empty list to store the tmap objects\ntmaps <- list()\n# Loop through each time period, create the KDE map, and add it to the list\nfor (i in seq_along(times)) {\n  tm <- tm_shape(densities[[i]] ) +\n    tm_raster(palette = \"YlOrRd\", \n              title = \"Conflict Density\",\n              style = \"cont\",\n              breaks = seq(0, max_density, length.out = 5)) +\n    tm_layout(title = paste(\"Explosions/Remote Violence Conflict Density - \", time_labels[i]),\n              legend.position = c(\"left\", \"bottom\"), \n              frame = FALSE)\n\n  # Add the tmap object to the list\n  tmaps[[i]] <- tm\n}\ntmap_animation(tmaps, filename = \"website_files/gif/explosions_conflict_density_animation.gif\", delay = 100, width = 800, height = 600)\n```\n:::\n\n\n![](website_files/gif/explosions_conflict_density_animation.gif)\n\n## Strategic Developments\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ntimes <- seq(2021.00, 2024.25, by = 0.25)  # From 2021 Q1 to 2024 Q2\ntime_labels <- sapply(times, function(t) {\n  year <- floor(t)\n  quarter <- ((t - year) * 4) + 1\n  paste(year, \"Q\", quarter, sep = \"\")\n})\n# Create an empty vector to store density values and list to store the KDE layers\nall_densities <- c()\ndensities <- list()\n\nfor (i in seq_along(times)) {\n  conflict_ppp <- strategic_quarter_ppp[strategic_quarter$year_quarter == times[i]]\n  conflict_ppp <- conflict_ppp[msrb_owin]\n  conflict_ppp.km <- rescale(conflict_ppp, 1000, \"km\")\n  density <- density(conflict_ppp.km, sigma = 50, edge = TRUE)\n  \n  # Convert density to raster and extract values\n  kde_raster <- raster(density)\n  projection(kde_raster) <- CRS(\"+init=EPSG:3414\")\n  \n  # Extract density values and add to all_densities\n  all_densities <- c(all_densities, values(kde_raster))\n  densities[[i]] <- kde_raster\n}\n\nmax_density <- max(all_densities, na.rm = TRUE)\n\n# Create an empty list to store the tmap objects\ntmaps <- list()\n# Loop through each time period, create the KDE map, and add it to the list\nfor (i in seq_along(times)) {\n  tm <- tm_shape(densities[[i]] ) +\n    tm_raster(palette = \"YlOrRd\", \n              title = \"Conflict Density\",\n              style = \"cont\",\n              breaks = seq(0, max_density, length.out = 5)) +\n    tm_layout(title = paste(\"Strategic Developments Conflict Density - \", time_labels[i]),\n              legend.position = c(\"left\", \"bottom\"), \n              frame = FALSE)\n\n  # Add the tmap object to the list\n  tmaps[[i]] <- tm\n}\ntmap_animation(tmaps, filename = \"website_files/gif/strategic_conflict_density_animation.gif\", delay = 100, width = 800, height = 600)\n```\n:::\n\n\n![](website_files/gif/strategic_conflict_density_animation.gif)\n\n## Violence Against Civilians\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ntimes <- seq(2021.00, 2024.25, by = 0.25)  # From 2021 Q1 to 2024 Q2\ntime_labels <- sapply(times, function(t) {\n  year <- floor(t)\n  quarter <- ((t - year) * 4) + 1\n  paste(year, \"Q\", quarter, sep = \"\")\n})\n# Create an empty vector to store density values and list to store the KDE layers\nall_densities <- c()\ndensities <- list()\n\nfor (i in seq_along(times)) {\n  conflict_ppp <- civilians_quarter_ppp[civilians_quarter$year_quarter == times[i]]\n  conflict_ppp <- conflict_ppp[msrb_owin]\n  conflict_ppp.km <- rescale(conflict_ppp, 1000, \"km\")\n  density <- density(conflict_ppp.km, sigma = 50, edge = TRUE)\n  \n  # Convert density to raster and extract values\n  kde_raster <- raster(density)\n  projection(kde_raster) <- CRS(\"+init=EPSG:3414\")\n  \n  # Extract density values and add to all_densities\n  all_densities <- c(all_densities, values(kde_raster))\n  densities[[i]] <- kde_raster\n}\n\nmax_density <- max(all_densities, na.rm = TRUE)\n\n# Create an empty list to store the tmap objects\ntmaps <- list()\n# Loop through each time period, create the KDE map, and add it to the list\nfor (i in seq_along(times)) {\n  tm <- tm_shape(densities[[i]] ) +\n    tm_raster(palette = \"YlOrRd\", \n              title = \"Conflict Density\",\n              style = \"cont\",\n              breaks = seq(0, max_density, length.out = 5)) +\n    tm_layout(title = paste(\"Violence Against Civilians Conflict Density - \", time_labels[i]),\n              legend.position = c(\"left\", \"bottom\"), \n              frame = FALSE)\n\n  # Add the tmap object to the list\n  tmaps[[i]] <- tm\n}\ntmap_animation(tmaps, filename = \"website_files/gif/civilians_conflict_density_animation.gif\", delay = 100, width = 800, height = 600)\n```\n:::\n\n\n![](website_files/gif/civilians_conflict_density_animation.gif)\n:::\n\n# 6. Second-Order Spatio-temporal Point Patterns Analysis using stpp's PCFhat\n\nRefer from :\n\n-   <https://mgimond.github.io/Spatial/chp11_0.html#first-and-second-order-effects>\n\n-   <https://rstudio-pubs-static.s3.amazonaws.com/333456_c3ace11fb9cb48d899a69e0b1e1b159e.html>\n\n## 6.1 Data preparation\n\nAs we want to perform 2nd-order spatio-temporal point patterns analysis, which we can re-use the quarterly ppp object that we have.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfiltered_msrb <- read_rds(\"data/rds/filtered_msrb.rds\")\nbattles_quarter_ppp <- read_rds(\"data/rds/battles_quarter_ppp.rds\")\nexplosions_quarter_ppp <- read_rds(\"data/rds/explosions_quarter_ppp.rds\")\nstrategic_quarter_ppp <- read_rds(\"data/rds/strategic_quarter_ppp.rds\")\ncivilians_quarter_ppp <- read_rds(\"data/rds/civilians_quarter_ppp.rds\")\n```\n:::\n\n\nTo check any duplicated points.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nany(duplicated(battles_quarter_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n\n```{.r .cell-code}\nany(duplicated(explosions_quarter_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n\n```{.r .cell-code}\nany(duplicated(strategic_quarter_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n\n```{.r .cell-code}\nany(duplicated(civilians_quarter_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n:::\n\n\nTo ensure that, our ppp object have time data associated with the points, we can use `str` function to check.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(battles_quarter_ppp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nList of 6\n $ window    :List of 4\n  ..$ type  : chr \"rectangle\"\n  ..$ xrange: num [1:2] -207135 591876\n  ..$ yrange: num [1:2] 1103500 3026505\n  ..$ units :List of 3\n  .. ..$ singular  : chr \"unit\"\n  .. ..$ plural    : chr \"units\"\n  .. ..$ multiplier: num 1\n  .. ..- attr(*, \"class\")= chr \"unitname\"\n  ..- attr(*, \"class\")= chr \"owin\"\n $ n         : int 12049\n $ x         : num [1:12049] 214364 198094 189680 146645 261929 ...\n $ y         : num [1:12049] 2452234 2499436 2533033 2427884 2556098 ...\n $ markformat: chr \"vector\"\n $ marks     : num [1:12049] 2024 2024 2024 2024 2024 ...\n - attr(*, \"class\")= chr \"ppp\"\n```\n\n\n:::\n:::\n\n\nNotice that **marks** field store our time field in quarters (2021.00 =\\> 2021 Q1, 2021.25 =\\> 2021 Q2 etc).\n\nTo ensure the field is compatible with the `PCFhat` function, I need to convert the values from double to integer. This involves transforming 2021.00 to 1, 2021.25 to 2, and so on, up to 2024.25 being converted to 14.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconvert_to_integer <- function(decimal) {\n  year <- floor(decimal)\n  quarter <- (decimal - year) * 4 + 1\n  quarter <- round(quarter)\n  return((year - 2021) * 4 + quarter)\n}\n\n# Convert marks to integers\nbattles_quarter_ppp$marks <- sapply(battles_quarter_ppp$marks, convert_to_integer)\nexplosions_quarter_ppp$marks <- sapply(explosions_quarter_ppp$marks, convert_to_integer)\nstrategic_quarter_ppp$marks <- sapply(strategic_quarter_ppp$marks, convert_to_integer)\ncivilians_quarter_ppp$marks <- sapply(civilians_quarter_ppp$marks, convert_to_integer)\n```\n:::\n\n\nTo use the PCFhat function, an error will occur if there are negative values in the x or y coordinates. I noticed that the CRS 32647, which we used to convert the sf object into a ppp object, generates negative values. Therefore, the code below offsets the negative x-coordinates by shifting all points to the right.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Transform and adjust filtered_msrb\nbbox <- st_bbox(filtered_msrb)\n# As I am using Myanmar region to find out the offset value for x-coordinates.\noffset_x <- -min(bbox$xmin, bbox$xmax)\n\n# Adjust x-coordinates, as STIKhat cannot handle negative coordinates.\nbattles_quarter_ppp$x <- battles_quarter_ppp$x + offset_x\nexplosions_quarter_ppp$x <- explosions_quarter_ppp$x + offset_x\nstrategic_quarter_ppp$x <- strategic_quarter_ppp$x + offset_x\ncivilians_quarter_ppp$x <- civilians_quarter_ppp$x + offset_x\n```\n:::\n\n\n## 6.2 Plotting Pair Correlation function\n\nThe code chunk below will create an stpp object for the battles data and verify that it is correctly formatted as an stpp object. Then, plot the Pair Correlation Function (PCF).\n\nSince the plot doesn’t display when rendered in the browser, I will save the image generated from the plotPCF function and use it for website display.\n\n::: panel-tabset\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(stpp)\nbattles_stpp <- as.3dpoints(\n  x = battles_quarter_ppp$x /1000, # change it in km\n  y = battles_quarter_ppp$y /1000, # change it in km\n  t = battles_quarter_ppp$marks\n)\nclass(battles_stpp)\nu <- seq(0,1000,by=50)\nv <- seq(0,14,by=1)\n# Use PCFhat function from stpp package\nbattles_pcf_result <- PCFhat(\n  xyt = battles_stpp,\n  t.region=c(1,14),\n  dist=u,\n  times=v,\n)\nplotPCF(battles_pcf_result, type = \"contour\", main = \"Battle - Contour Plot\")\nplotPCF(battles_pcf_result, type = \"persp\", main = \"Battle - Perspective Plot\")\nplotPCF(battles_pcf_result, type = \"image\", main = \"Battle - Image Plot\")\n```\n:::\n\n\n![](website_files/PCFhat/battle_image.png) ![](website_files/PCFhat/battle_persp.png) ![](website_files/PCFhat/battle_contour.png)\n\n## Explosions/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nexplosions_stpp <- as.3dpoints(\n  x = explosions_quarter_ppp$x /1000, # change it in km\n  y = explosions_quarter_ppp$y /1000, # change it in km\n  t = explosions_quarter_ppp$marks\n)\nclass(explosions_stpp)\n\nu <- seq(0,1000,by=50)\nv <- seq(0,14,by=1)\n# Use PCFhat function from stpp package\nexplosions_pcf_result <- PCFhat(\n  xyt = explosions_stpp,\n  t.region=c(1,14),\n  dist=u,\n  times=v,\n)\n\nplotPCF(explosions_pcf_result, type = \"contour\", main = \"Explosions/Remote violence - Contour Plot\")\nplotPCF(explosions_pcf_result, type = \"persp\", main = \"Explosions/Remote violence - Perspective Plot\")\nplotPCF(explosions_pcf_result, type = \"image\", main = \"Explosions/Remote violence - Image Plot\")\n```\n:::\n\n\n![](website_files/PCFhat/explosions_image.png) ![](website_files/PCFhat/explosions_persp.png) ![](website_files/PCFhat/explosions_contour.png)\n\n## Strategic developments\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nstrategic_stpp <- as.3dpoints(\n  x = strategic_quarter_ppp$x /1000, # change it in km\n  y = strategic_quarter_ppp$y /1000, # change it in km\n  t = strategic_quarter_ppp$marks\n)\nclass(strategic_stpp)\n\nu <- seq(0,1000,by=50)\nv <- seq(0,14,by=1)\n# Use PCFhat function from stpp package\nstrategic_pcf_result <- PCFhat(\n  xyt = strategic_stpp,\n  t.region=c(1,14),\n  dist=u,\n  times=v,\n)\n\nplotPCF(strategic_pcf_result, type = \"contour\", main = \"Strategic developments - Contour Plot\")\nplotPCF(strategic_pcf_result, type = \"persp\", main = \"Strategic developments - Perspective Plot\")\nplotPCF(strategic_pcf_result, type = \"image\", main = \"Strategic developments - Image Plot\")\n```\n:::\n\n\n![](website_files/PCFhat/strategic_image.png) ![](website_files/PCFhat/strategic_persp.png) ![](website_files/PCFhat/strategic_contour.png)\n\n## Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncivilians_stpp <- as.3dpoints(\n  x = civilians_quarter_ppp$x /1000, # change it in km\n  y = civilians_quarter_ppp$y /1000, # change it in km\n  t = civilians_quarter_ppp$marks\n)\nclass(civilians_stpp)\n\nu <- seq(0,1000,by=50)\nv <- seq(0,14,by=1)\n# Use PCFhat function from stpp package\ncivilians_pcf_result <- PCFhat(\n  xyt = civilians_stpp,\n  t.region=c(1,14),\n  dist=u,\n  times=v,\n)\n\nplotPCF(civilians_pcf_result, type = \"contour\", main = \"Violence against civilians - Contour Plot\")\nplotPCF(civilians_pcf_result, type = \"persp\", main = \"Violence against civilians - Perspective Plot\")\nplotPCF(civilians_pcf_result, type = \"image\", main = \"Violence against civilians - Image Plot\")\n```\n:::\n\n\n![](website_files/PCFhat/civilians_image.png) ![](website_files/PCFhat/civilians_persp.png) ![](website_files/PCFhat/civilians_contour.png)\n:::\n\n## 6.3 Insight\n\n::: callout-note\n-   x-axis = distance; y-axis = time\n\n-   How to interpret PCF values:\n\n    -   **PCF = 1**: Indicates random distribution of events.\n\n    -   **PCF \\> 1**: indicate clustering of events, meaning events are likely occur close to each other spatially and temporally.\n\n    -   **PCF \\<1**: indicate inhibition in space-time, meaning events are less likely to occur close to each other spatially and temporally.\n\n-   Based on the image plot of the 4 event types, I observed that among the 4 Spatio-temporal PCF plots, there are two heavy density area:\n\n    -   1 =\\> distance from 0 to 100 km\n\n    -   2 =\\> distance from 280 to 350 km\n\n    -   Based on the KDE analysis, I suspect these two areas represent the central region (bordering Magway, Mandalay, and Sagaing states) and the southern region (around Bago, Yangon, and Mon states). As the KDE suggests that these regions have experienced the highest concentration of events.\n\n-   The Spatio-temporal PCF plots also support my previous insight from the KDE regarding the correlation between event types. **Battles** and **Explosions/Remote Violence** appear to be correlated, while **Strategic Developments** and **Violence Against Civilians** also show a correlation.\n:::\n\n# 7. Conclusion & Thoughts\n\nThe armed conflict data of Myanmar from January 2021 to June 2024 has provided valuable insights through Spatial Point Pattern Analysis. It has helped me identify the regions most affected by conflict and track how the conflict has evolved over time. Encouragingly, the analysis suggests a downward trend in conflict intensity since the peak around 2022 Q4, signaling a potential improvement in the situation.\n\nThis exercise has been a good exploration for me, as I do not have much any experience in doing analysis on data, especially on the events that are very close related to us. It was a pretty fun experience, but also a very challenging one compare to my other assignments in school. As I am new to R and not so familiar with the proper steps on handling the data etc, which cause me often re-doing steps to improve the result and the rendering process really make me frustrated. However, I feel I have gain more compare to the pain. After the exercise, it really make me understand much better on the concept I have learnt at the first weeks.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}